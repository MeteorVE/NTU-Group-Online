(function(e){function t(t){for(var n,i,c=t[0],s=t[1],l=t[2],u=0,d=[];u<c.length;u++)i=c[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&d.push(r[i][0]),r[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);m&&m(t);while(d.length)d.shift()();return a.push.apply(a,l||[]),o()}function o(){for(var e,t=0;t<a.length;t++){for(var o=a[t],n=!0,i=1;i<o.length;i++){var s=o[i];0!==r[s]&&(n=!1)}n&&(a.splice(t--,1),e=c(c.s=o[0]))}return e}var n={},r={app:0},a=[];function i(e){return c.p+"js/"+({about:"about"}[e]||e)+"."+{about:"e0c8357b"}[e]+".js"}function c(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,c),o.l=!0,o.exports}c.e=function(e){var t=[],o=r[e];if(0!==o)if(o)t.push(o[2]);else{var n=new Promise((function(t,n){o=r[e]=[t,n]}));t.push(o[2]=n);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,c.nc&&s.setAttribute("nonce",c.nc),s.src=i(e);var l=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(u);var o=r[e];if(0!==o){if(o){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",l.name="ChunkLoadError",l.type=n,l.request=a,o[1](l)}r[e]=void 0}};var u=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},c.m=e,c.c=n,c.d=function(e,t,o){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(c.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(o,n,function(t){return e[t]}.bind(null,n));return o},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var m=l;a.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"155e":function(e,t,o){},"1bed":function(e,t,o){},2303:function(e,t,o){"use strict";o("fdac")},"27e4":function(e,t,o){},"32b9":function(e,t,o){"use strict";var n=o("d4ec"),r=o("4360"),a=o("1232"),i="wss://ntu-online-group-ws.herokuapp.com",c=i+"/wsServer/connection/user/",s=i+"/ws/room/",l=function e(t,o,r){Object(n["a"])(this,e),this.websocket=t,this.userID=o,this.token=r},u=function e(t,o,r,a){Object(n["a"])(this,e),this.websocket=t,this.userID=o,this.roomID=r,this.token=a};t["a"]={InitNotifyWebsocket:function(e){var t=Object(a["a"])(e);r["a"].state.user_id=t.user_id;var o=t.user_id,n=new WebSocket(c+o);return n.onopen=function(){var t={user_id:o,token:e};n.send(JSON.stringify(t));var a=new l(n,r["a"].state.user_id,e);r["a"].state.notifyWebsocketConn=a},n.onclose=function(){console.log("Notification websocket close")},n},InitRoomWebsocket:function(e,t){var o=Object(a["a"])(e),n=o.user_id,i=new WebSocket(s+t);return i.onopen=function(){var o={user_id:n,token:e};i.send(JSON.stringify(o));var a=new u(i,n,t,e);r["a"].state.roomWebsocketConn[t]=a},i.onclose=function(){console.log("Room ID: "+t+" websocket close")},i}}},3808:function(e,t,o){},"3aea":function(e,t,o){"use strict";var n=o("2909"),r=o("ade3"),a=(o("d3b7"),o("d81d"),o("b64b"),o("99af"),o("25f0"),o("fb6a"),o("bc3a")),i=o.n(a),c=o("4360"),s=o("a18c");i.a.defaults.xsrfCookieName="csrftoken",i.a.defaults.xsrfHeaderName="X-CSRFToken";var l=i.a.create({baseURL:"https://ntu-online-group-api.herokuapp.com/",withCredentials:!1,headers:{Accept:"application/json","Content-Type":"application/json"}});l.interceptors.request.use((function(e){var t=c["a"].state.token;return t&&(e.headers.Authorization="Bearer "+t),e}),(function(e){return Promise.reject(e)})),l.interceptors.response.use((function(e){return Promise.resolve(e)}),(function(e){if(e&&e.response)switch(e.response.status){case 401:console.log("登入無效"),c["a"].dispatch("logout"),s["a"].push("/");break;case 404:console.log("找不到該頁面");break;case 500:console.log("伺服器出錯");break;case 503:console.log("服務失效");break;default:console.log("連接錯誤".concat(e.response.status))}else console.log("連接到服務器失敗");return Promise.reject(e.response)})),t["a"]={renameKeys:function(e,t){var o=Object.keys(e).map((function(o){var n=t[o]||o;return Object(r["a"])({},n,e[o])}));return Object.assign.apply(Object,[{}].concat(Object(n["a"])(o)))},getRooms:function(){return l.get("/room/")},postRoom:function(e){console.log("[Room]:",e.date2.toString());var t={description:"introduction",type:"room_type",capacity:"people_limit",category:"room_category"},o=this.renameKeys(e,t);return o["valid_time"]=e.date1.getFullYear()+"-"+(e.date1.getMonth()+1)+"-"+e.date1.getDate()+" "+e.date2.toString().slice(16,24),console.log("[renamedRoom]:",o),l.post("/room/",o)},getRoom:function(e){return l.get("/room/"+e+"/")},putRoom:function(e,t){return l.put("/room/"+e+"/",t)},getRoomMemberList:function(e){return l.get("/room/"+e+"/member_list/")},getRoomBlockList:function(e){return l.get("/room/"+e+"/block_list/")},postJoinRoom:function(e,t){return l.post("/room/"+e+"/join_room/",{nickname:t})},deleteLeaveRoom:function(e){return l.delete("room/"+e+"/leave_room/")},deleteRoom:function(e){return l.delete("room/"+e+"/")},getRoomCategory:function(){return l.get("/room/category_list/")},getRoomType:function(){return l.get("/room/type_list/")},postBlockUser:function(e,t,o){return l.post("/room/"+e+"/block/"+t+"/",{reason:o})},deleteUnblockUser:function(e,t){return l.delete("/room/"+e+"/unblock/"+t+"/")},deleteRemoveUser:function(e,t,o){return l.delete("/room/"+e+"/remove/"+t+"/",{reason:o})},putTransferAdmin:function(e,t){return l.put("/room/"+e+"/transfer_admin/"+t+"/")},putSetLevel:function(e,t){return l.put("/room/"+e+"/set_access_level/",t)},getRoomInvitationList:function(e){return l.get("/room/"+e+"/invitation/")},postRoomInvite:function(e,t){return l.post("/room/"+e+"/invite/"+t+"/")},getRoomRecord:function(e){return l.get("/room_record/"+e+"/")},getUserId:function(){return l.get("/api/user/get_id/")},getUserDetail:function(e){return l.get("/api/user/"+e+"/")},getUserRooms:function(){return l.get("/user_room/")},getMailVerify:function(e,t){return l.get("/api/user/verify_email/"+e+"/"+t+"/")},postResetPassword:function(e,t,o){return l.post("/api/user/password_reset/"+e+"/"+t+"/",{password:o})},postRegister:function(e){return l.post("/api/user/register/",e)}}},"3cfb":function(e,t,o){},"3d9b":function(e,t,o){},4360:function(e,t,o){"use strict";var n=o("1da1"),r=(o("d3b7"),o("96cf"),o("5502")),a=o("bc3a"),i=o.n(a),c=o("a18c");i.a.defaults.xsrfCookieName="csrftoken",i.a.defaults.xsrfHeaderName="X-CSRFToken";var s=i.a.create({baseURL:"https://ntu-online-group-api.herokuapp.com/",withCredentials:!1,headers:{Accept:"application/json","Content-Type":"application/json"}});s.interceptors.request.use((function(e){var t=m.state.token;return t&&(e.headers.Authorization="Bearer "+t),e}),(function(e){return Promise.reject(e)})),s.interceptors.response.use((function(e){return Promise.resolve(e)}),(function(e){if(e&&e.response)switch(e.response.status){case 401:console.log("登入無效"),m.dispatch("logout"),c["a"].push("/");break;case 404:console.log("找不到該頁面");break;case 500:console.log("伺服器出錯");break;case 503:console.log("服務失效");break;default:console.log("連接錯誤".concat(e.response.status))}else console.log("連接到服務器失敗");return Promise.reject(e.response)}));var l={postLogin:function(e){return s.post("/token/",{email:e["email"],password:e["password"]})},postVerifyToken:function(e){return s.post("/token/verify/",e)},postRefreshToken:function(e){return s.post("/token/refresh/",e)},getRoom:function(e){return s.get("/rooms/"+e)},postRoom:function(e){return s.post("/rooms",e)}},u=o("3aea"),m=t["a"]=Object(r["a"])({state:{filter:"",roomWebsocketConn:{},notifyWebsocketConn:null,user_id:-1,is_verify:null,first_connect:!0,token:localStorage.getItem("token")||"",refreshToken:localStorage.getItem("refresh_token")||""},mutations:{SET_TOKEN:function(e,t){"access"in t&&(e.token=t["access"],localStorage.setItem("token",t["access"])),"refresh"in t&&(e.refreshToken=t["refresh"],localStorage.setItem("refresh_token",t["refresh"]))},SET_VERIFY:function(e,t){e.is_verify=t},SET_UID:function(e,t){e.user_id=t}},actions:{login:function(e,t){var o=e.commit;return l.postLogin(t).then((function(e){200==e.status&&o("SET_TOKEN",e.data)}))},logout:function(e){return Object(n["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e.dispatch,localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),t.next=5,o("resetToken");case 5:return console.log("complete logout"),t.abrupt("return","success");case 7:case"end":return t.stop()}}),t)})))()},verifyToken:function(){return l.postVerifyToken({token:this.state.token})},refreshToken:function(e){var t=e.commit;return l.postRefreshToken({refresh:this.state.refreshToken||"invalid_refresh_token_setting_for"}).then((function(e){if(200==e.status)return t("SET_TOKEN",e.data),localStorage.setItem("token",e.data["access"]),Promise.resolve(e);console.log("[Action refreshToken]: 理論上不會出現這行",e)}))},resetToken:function(e){return Object(n["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e.commit,t.next=3,o("SET_TOKEN",{access:"",refresh:""});case 3:localStorage.removeItem("token"),localStorage.removeItem("refresh_token");case 5:case"end":return t.stop()}}),t)})))()},getIsVerify:function(e){return Object(n["a"])(regeneratorRuntime.mark((function t(){var o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e.commit,n=-1,t.next=4,u["a"].getUserId().then((function(e){return n=e.data.id,u["a"].getUserDetail(n)})).then((function(e){1==e.data.is_verify?o("SET_VERIFY",!0):o("SET_VERIFY",!1)})).catch((function(e){console.log("[store.getIsVerify err]:",e)}));case 4:case"end":return t.stop()}}),t)})))()},getUserId:function(e){return Object(n["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e.commit,t.next=3,u["a"].getUserId().then((function(e){o("SET_UID",e.data.id)})).catch((function(e){console.log("[store.getUserId err]:",e)}));case 3:case"end":return t.stop()}}),t)})))()}},getters:{getToken:function(e){return e.token},isAuth:function(e){return!!e.token}},modules:{}})},"469f":function(e,t,o){"use strict";o("5cc0")},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d"),o("159b"),o("d3b7"),o("ddb0"),o("ac1f"),o("5319");var n=o("8103"),r=o.n(n),a=o("bba4"),i=o.n(a),c=o("7a23"),s={id:"app"};function l(e,t,o,n,r,a){var i=Object(c["M"])("NavBar"),l=Object(c["M"])("router-view");return Object(c["D"])(),Object(c["i"])("div",s,[Object(c["m"])(i,{onLogoutsignal:a.logouthandle},null,8,["onLogoutsignal"]),Object(c["m"])(l,{key:e.$route.fullPath,onWsConnStart:a.initWs},null,8,["onWsConnStart"])])}var u=o("5530"),m=(o("841c"),Object(c["fb"])("data-v-2ada9471"));Object(c["G"])("data-v-2ada9471");var d={id:"nav",class:"nav"},b={class:"menu-item-group left-group"},f=Object(c["l"])("Homepage"),p=Object(c["m"])("i",{class:"el-icon-plus"},null,-1),g=Object(c["m"])("i",{class:"el-icon-bell"},null,-1),h=Object(c["l"])(" About "),j=Object(c["l"])(" Login "),O=Object(c["l"])(" Logout "),v=Object(c["l"])(" Register "),_=Object(c["l"])(" User "),y={class:"menu-item-group right-group"},k=Object(c["m"])("i",{class:"el-icon-search"},null,-1);Object(c["E"])();var w=m((function(e,t,o,n,r,a){var i=Object(c["M"])("el-menu-item"),s=Object(c["M"])("el-input"),l=Object(c["M"])("el-menu");return Object(c["D"])(),Object(c["i"])("div",d,[Object(c["m"])(l,{"default-active":e.$route.path,class:"el-menu-nav",mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",router:""},{default:m((function(){return[Object(c["m"])("div",b,[Object(c["m"])(i,{route:"/",index:"/",onClick:a.clearFilter},{default:m((function(){return[f]})),_:1},8,["onClick"]),Object(c["m"])(i,{class:"plus",route:"/room/create",index:"/room/create"},{default:m((function(){return[p]})),_:1}),Object(c["m"])(i,{class:"bell",index:"5"},{default:m((function(){return[g]})),_:1}),Object(c["m"])(i,{route:"/about",index:"/about"},{default:m((function(){return[h]})),_:1}),e.isAuth?Object(c["j"])("",!0):(Object(c["D"])(),Object(c["i"])(i,{key:0,route:"/login",index:"/login"},{default:m((function(){return[j]})),_:1})),Object(c["m"])(i,{onClick:a.logout},{default:m((function(){return[O]})),_:1},8,["onClick"]),e.isAuth?Object(c["j"])("",!0):(Object(c["D"])(),Object(c["i"])(i,{key:1,route:"/register",index:"/register"},{default:m((function(){return[v]})),_:1})),Object(c["m"])(i,{route:"/profile",index:"/profile"},{default:m((function(){return[_]})),_:1})]),Object(c["m"])("div",y,[Object(c["m"])(i,{class:"searchbar",index:"/"},{default:m((function(){return[Object(c["m"])(s,{placeholder:"搜尋",modelValue:r.searchInput,"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.searchInput=e}),onKeydown:a.search},null,8,["modelValue","onKeydown"])]})),_:1}),Object(c["m"])(i,{class:"search",index:"/",onClick:a.applyFilter},{default:m((function(){return[k]})),_:1},8,["onClick"])])]})),_:1},8,["default-active"])])})),R=(o("4de4"),o("5502")),x={data:function(){return{searchInput:""}},watch:{},created:function(){},computed:Object(u["a"])({},Object(R["b"])(["isAuth"])),methods:{logout:function(){var e=this;this.$store.dispatch("logout",{}).then((function(){e.$router.push({name:"home"})})).catch((function(){console.log("There was a problem when logout")})),this.$emit("logoutsignal",!0)},clearFilter:function(){this.$store.state.filter=""},search:function(e){"Enter"==e.key&&this.applyFilter()},applyFilter:function(){this.searchInput&&(this.$store.state.filter=this.searchInput,this.searchInput="")}}};o("acb1");x.render=w,x.__scopeId="data-v-2ada9471";var M=x,$=o("32b9"),C={components:{NavBar:M},data:function(){return{textarea:"",hasInitWs:!1,notifyws:null}},created:function(){var e=this;this.textarea="",this.$store.state.token&&!1===this.hasInitWs&&(this.hasInitWs=!0,this.notifyws=$["a"].InitNotifyWebsocket(this.$store.state.token),console.log(this.notifyws),console.log("notify websocket init success"),this.notifyws.onmessage=function(t){var o=JSON.parse(t.data);switch(o.header){case"setConn":"Success Connect"!=o.res?console.log("Authentication Error or Websocket server Error"):(console.log(e.notifyws),console.log("notify websocket init success"));break;case"notify":console.log(o.notify_string),"notify"===o.notify_string&&console.log("You have notify");break;case"ping":break}}),this.$store.state.token&&this.$store.dispatch("getIsVerify").then((function(){console.log("is_verify:",e.$store.state.is_verify)}))},watch:{roomWebsocketConn:function(e){this.textarea=e}},computed:Object(u["a"])({},Object(R["c"])(["token","roomWebsocketConn"])),methods:{copyClipboard:function(){var e=document.body.appendChild(document.createElement("input"));e.setAttribute("value",this.textarea),e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),console.log(this.textarea)},testReturn:function(){var e=this.testAPI();console.log("in testReturn :",e,this.consoleText)},testAPI:function(){this.$store.dispatch("verifyToken",this.event).then((function(e){return console.log("[App.vue] testAPI, then:",e,e.data),e})).catch((function(e){return console.log("[App.vue] testAPI, catch: There was a problem in test API"),console.log(e.response.data),e.response.data}))},initWs:function(e){var t=this;!0===e&&!1===this.hasInitWs&&(this.hasInitWs=!0,this.$store.state.token&&null==this.notifyws&&(console.log("initiate"),this.notifyws=$["a"].InitNotifyWebsocket(this.$store.state.token),this.notifyws.onmessage=function(e){var o=JSON.parse(e.data);switch(o.header){case"setConn":"Success Connect"!=o.res?console.log("Authentication Error or Websocket server Error"):(console.log(t.notifyws),console.log("notify websocket init success"));break;case"notify":console.log(o.notify_string),"notify"===o.notify_string&&console.log("You have notify");break;case"ping":break}}))},logouthandle:function(){this.hasInitWs=!1,console.log("websocket close"),null!=this.notifyws&&(this.notifyws.close(),this.notifyws=null)}}};o("b740");C.render=l;var V=C,L=o("a18c"),I=o("4360"),D=o("3fd4"),S=(o("7dd6"),o("1fa0")),P=o("14b7");console.log("https://ntu-online-group-api.herokuapp.com/"),console.log("wss://ntu-online-group-ws.herokuapp.com"),console.log("here_is_local");var T=Object(c["h"])(V),N=Object(P["a"])();T.config.globalProperties.emitter=N,T.use(I["a"]).use(L["a"]).use(D["b"]).use(S["a"]).mount("#app");var U=o("ef13");U.keys().forEach((function(e){var t=U(e),o=r()(i()(e.replace(/^\.\/(.*)\.\w+$/,"$1")));T.component(o,t.default||t)}))},"5cc0":function(e,t,o){},"668f":function(e,t,o){"use strict";o("155e")},"73eb":function(e,t,o){"use strict";o("3d9b")},"77b6":function(e,t,o){"use strict";o("1bed")},"7e35":function(e,t,o){"use strict";o("c5b9")},"8bd8":function(e,t,o){"use strict";o("a01d")},a01d:function(e,t,o){},a18c:function(e,t,o){"use strict";o("d3b7"),o("3ca3"),o("ddb0");var n=o("6c02"),r=(o("d81d"),o("25f0"),o("7a23")),a=Object(r["fb"])("data-v-139dc7c4");Object(r["G"])("data-v-139dc7c4");var i={class:"home"},c={key:0,"transition-duration":"0.2s","item-selector":".item","column-width":".item",class:"rooms-container"},s={key:1},l={class:"dialog-footer"},u=Object(r["l"])("取 消"),m=Object(r["l"])("送出");Object(r["E"])();var d=a((function(e,t,o,n,d,b){var f=Object(r["M"])("SideBar"),p=Object(r["M"])("el-aside"),g=Object(r["M"])("RoomCard"),h=Object(r["M"])("el-empty"),j=Object(r["M"])("el-main"),O=Object(r["M"])("el-container"),v=Object(r["M"])("el-form-item"),_=Object(r["M"])("el-tag"),y=Object(r["M"])("el-input"),k=Object(r["M"])("el-form"),w=Object(r["M"])("el-button"),R=Object(r["M"])("el-dialog"),x=Object(r["N"])("masonry-tile"),M=Object(r["N"])("masonry");return Object(r["D"])(),Object(r["i"])("div",i,[Object(r["m"])(O,null,{default:a((function(){return[Object(r["m"])(p,{width:"160px"},{default:a((function(){return[Object(r["m"])(f,{onApplyFilter:t[1]||(t[1]=function(e){return b.updateFilter(e)}),sideBarList:d.sideBarList.map((function(e){return{text:e,url:""}})),urlMode:!1},null,8,["sideBarList"])]})),_:1}),Object(r["m"])(j,{id:"roomCardContainer"},{default:a((function(){return[b.filteredRooms.length>0?Object(r["cb"])((Object(r["D"])(),Object(r["i"])("div",c,[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(b.filteredRooms,(function(e,t){return Object(r["cb"])((Object(r["D"])(),Object(r["i"])("div",{class:"item",key:t},[Object(r["m"])(g,{room:e,typeDict:d.roomTypeDict,onUpdate:b.updateClickedRoom,imageList:d.imageList},null,8,["room","typeDict","onUpdate","imageList"])],512)),[[x]])})),128))],512)),[[M]]):(Object(r["D"])(),Object(r["i"])("div",s,[Object(r["m"])(h,{description:"找不到相關結果"})]))]})),_:1})]})),_:1}),Object(r["m"])(R,{title:"加入房間",modelValue:d.dialogFormVisible,"onUpdate:modelValue":t[4]||(t[4]=function(e){return d.dialogFormVisible=e})},{footer:a((function(){return[Object(r["m"])("span",l,[Object(r["m"])(w,{onClick:t[3]||(t[3]=function(e){return d.dialogFormVisible=!1})},{default:a((function(){return[u]})),_:1}),Object(r["m"])(w,{type:"primary",onClick:b.joinRoom},{default:a((function(){return[m]})),_:1},8,["onClick"])])]})),default:a((function(){return[Object(r["m"])(k,{model:d.dialogFormRoom,"label-position":"left"},{default:a((function(){return[Object(r["m"])(v,{label:"房間名稱","label-width":d.formLabelWidth},{default:a((function(){return[Object(r["m"])(v,{label:d.dialogFormRoom.title},null,8,["label"])]})),_:1},8,["label-width"]),Object(r["m"])(v,{label:"房間 Type","label-width":d.formLabelWidth},{default:a((function(){return[Object(r["m"])(_,{type:"info"},{default:a((function(){return[Object(r["l"])(Object(r["Q"])(d.dialogFormRoom.room_type),1)]})),_:1})]})),_:1},8,["label-width"]),Object(r["m"])(v,{label:"房間 Category","label-width":d.formLabelWidth},{default:a((function(){return[Object(r["m"])(_,{type:"success",style:{"text-align":"left"}},{default:a((function(){return[Object(r["l"])(Object(r["Q"])(d.dialogFormRoom.room_category),1)]})),_:1})]})),_:1},8,["label-width"]),Object(r["m"])(v,{label:"簡介","label-width":d.formLabelWidth,class:"desc"},{default:a((function(){return[Object(r["m"])(v,{label:d.dialogFormRoom.introduction},null,8,["label"])]})),_:1},8,["label-width"]),Object(r["m"])(v,{label:"最大人數","label-width":d.formLabelWidth},{default:a((function(){return[Object(r["m"])(v,{label:d.dialogFormRoom.people_limit.toString()},null,8,["label"])]})),_:1},8,["label-width"]),Object(r["m"])(v,{label:"您的暱稱","label-width":d.formLabelWidth},{default:a((function(){return[Object(r["m"])(y,{modelValue:d.user.nickname,"onUpdate:modelValue":t[2]||(t[2]=function(e){return d.user.nickname=e}),autocomplete:"off",clearable:"",placeholder:"請輸入暱稱"},null,8,["modelValue"])]})),_:1},8,["label-width"])]})),_:1},8,["model"])]})),_:1},8,["modelValue"])])})),b=o("5530"),f=(o("4de4"),o("caad"),o("2532"),Object(r["fb"])("data-v-0591ce70"));Object(r["G"])("data-v-0591ce70");var p=Object(r["m"])("p",null,"分類 :",-1),g={style:{"text-align":"center"}},h=Object(r["l"])("進入房間");Object(r["E"])();var j=f((function(e,t,o,n,a,i){var c=Object(r["M"])("el-skeleton-item"),s=Object(r["M"])("el-skeleton"),l=Object(r["M"])("el-tag"),u=Object(r["M"])("el-button"),m=Object(r["M"])("el-card");return Object(r["D"])(),Object(r["i"])(m,{"body-style":{padding:"0px"}},{default:f((function(){return[o.room.image_url&&!a.imageLoadFailed?(Object(r["D"])(),Object(r["i"])("img",{key:0,src:o.room.image_url,class:"image",onError:t[1]||(t[1]=function(e){return a.imageLoadFailed=!0})},null,40,["src"])):(Object(r["D"])(),Object(r["i"])(s,{key:1},{template:f((function(){return[Object(r["m"])(c,{variant:"image",style:{height:"150px"}})]})),_:1})),Object(r["m"])("h4",null,Object(r["Q"])(o.room.title),1),Object(r["m"])("div",null,[p,Object(r["m"])(l,{type:"success"},{default:f((function(){return[Object(r["l"])(Object(r["Q"])(i.getCategoryName()),1)]})),_:1}),Object(r["m"])(l,{type:"info"},{default:f((function(){return[Object(r["l"])(Object(r["Q"])(o.typeDict[o.room.room_type]?o.typeDict[o.room.room_type]:o.room.room_type),1)]})),_:1})]),Object(r["m"])("div",null,[Object(r["m"])("p",null,"人數限制 : "+Object(r["Q"])(o.room.people_limit),1),Object(r["m"])("p",null,"簡介 : "+Object(r["Q"])(i.introduction),1),Object(r["m"])("div",g,[Object(r["m"])(u,{type:"text",onClick:i.emitParent},{default:f((function(){return[h]})),_:1},8,["onClick"])])])]})),_:1})})),O=(o("fb6a"),o("7db0"),{props:{room:Object,typeDict:Object,imageList:Array},computed:{introduction:function(){return this.room.introduction.length>30?this.room.introduction.slice(0,30)+"...":this.room.introduction}},data:function(){return{images:["https://i.imgur.com/kN4J0UL.jpg","","https://i.imgur.com/17SSeJb.png","https://i.imgur.com/85zF3RK.jpg","https://i.imgur.com/o2uS5WX.png","https://i.imgur.com/wc0HqRT.png","https://i.imgur.com/qdIZSWc.jpg","https://i.imgur.com/GOaM9dB.jpg","https://i.imgur.com/G65qPbl.jpg","https://i.imgur.com/WxiJ6K0.jpg"],dialogFormVisible:!1,imageLoadFailed:!1}},methods:{emitParent:function(){this.$emit("update",{dialogFormRoom:this.room,dialogFormVisible:!0,clickedRoomId:this.room.id})},getCategoryName:function(){var e=this,t=this.imageList.find((function(t){return t.category==e.room.room_category}));return t?t.value:this.room.room_category}},watch:{dialogFormRoom:{handler:function(e){this.$emit("update",{dialogFormRoom:e,dialogFormVisible:!0}),this.dialogFormRoom=""}}}});o("cf76");O.render=j,O.__scopeId="data-v-0591ce70";var v=O,_=Object(r["m"])("i",{class:"el-icon-menu"},null,-1),y=Object(r["m"])("i",{class:"el-icon-menu"},null,-1);function k(e,t,o,n,a,i){var c=Object(r["M"])("el-menu-item"),s=Object(r["M"])("el-menu"),l=Object(r["M"])("el-scrollbar");return o.urlMode?(Object(r["D"])(),Object(r["i"])(s,{key:0,"default-active":e.$route.path,class:"SideBar",router:""},{default:Object(r["bb"])((function(){return[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(o.sideBarList,(function(e,t){return Object(r["D"])(),Object(r["i"])(c,{key:t,index:e.url,route:e.url},{default:Object(r["bb"])((function(){return[_,Object(r["m"])("span",null,Object(r["Q"])(e.text),1)]})),_:2},1032,["index","route"])})),128))]})),_:1},8,["default-active"])):(Object(r["D"])(),Object(r["i"])(s,{key:1,class:"SideBar"},{default:Object(r["bb"])((function(){return[Object(r["m"])(l,null,{default:Object(r["bb"])((function(){return[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(o.sideBarList,(function(e,t){return Object(r["D"])(),Object(r["i"])(c,{key:t,index:t.toString(),onClick:function(t){return i.applyFilter(e)}},{default:Object(r["bb"])((function(){return[y,Object(r["m"])("span",null,Object(r["Q"])(e.text),1)]})),_:2},1032,["index","onClick"])})),128))]})),_:1})]})),_:1}))}var w={props:["sideBarList","urlMode"],methods:{applyFilter:function(e){this.$store.state.filter!==e.text?this.$store.state.filter=e.text:this.$store.state.filter=""}}};o("668f");w.render=k;var R=w,x=o("3aea"),M=o("5502"),$={components:{RoomCard:v,SideBar:R},data:function(){var e=[{value:"自定義",url:"",category:""},{value:"課程討論",url:"https://i.imgur.com/GIiSOLM.jpg",category:"course"},{value:"吃飯",url:"https://i.imgur.com/kN4J0UL.jpg",category:"eating"},{value:"爬山",url:"https://i.imgur.com/17SSeJb.png",category:"hiking"},{value:"打籃球",url:"https://i.imgur.com/o2uS5WX.png",category:"baseketball"},{value:"打 Apex",url:"https://i.imgur.com/PkZu9rV.jpg",category:"apex"},{value:"玩 Switch 遊戲",url:"https://i.imgur.com/16C4zzd.png",category:"switch"},{value:"跑步",url:"https://i.imgur.com/wc0HqRT.png",category:"running"},{value:"團購",url:"https://i.imgur.com/hcP3JA2.png",category:"group_buying"},{value:"逛街",url:"https://i.imgur.com/85zF3RK.jpg",category:"shopping"},{value:"打遊戲",url:"https://i.imgur.com/ex5uIMF.jpg",category:"game"},{value:"買衣服",url:"https://i.imgur.com/UElotjt.jpg",category:"clothing"},{value:"麥當勞",url:"https://i.imgur.com/Ll9w1eq.png",category:"mc"},{value:"肯德基",url:"https://i.imgur.com/NBt3Xka.jpg",category:"kfc"},{value:"看電影",url:"https://i.imgur.com/QzZKggo.png",category:"moive"},{value:"演唱會",url:"https://i.imgur.com/NBt3Xka.jpg",category:"live"},{value:"打桌球",url:"https://i.imgur.com/kluQV3e.jpg",category:"tabletennis"},{value:"讀書",url:"https://i.imgur.com/jneYUkV.jpg",category:"study"},{value:"讀書會",url:"https://i.imgur.com/rM3O9xh.png",category:"studyclub"},{value:"看比賽",url:"https://i.imgur.com/Yya0Www.png",category:"race"}];return{imageList:e,rooms:[],userRooms:[],dialogFormVisible:!1,dialogFormRoom:"",formLabelWidth:"120px",roomTypeDict:[],sideBarList:[],category:["吃飯","團購","遊戲","聊天","共乘","交易","分組","出遊"],user:{nickname:""}}},computed:Object(b["a"])(Object(b["a"])({},Object(M["b"])(["isAuth"])),{},{filteredRooms:function(){var e=this;return this.$store.state.filter?this.rooms.filter((function(t){return t.room_category.includes(e.$store.state.filter)||t.introduction.includes(e.$store.state.filter)||t.title.includes(e.$store.state.filter)})):this.rooms}}),created:function(){var e=this;this.$store.state.token&&!this.$store.state.is_verify&&this.$store.dispatch("getIsVerify").then((function(){0==e.$store.state.is_verify&&(e.$router.push({name:"profile"}),e.$message.error("未過 mail 認證 !"))})),this.$store.state.token?this.$store.dispatch("refreshToken").then((function(t){console.log("token:",t.data,"\nstart to get some list:"),x["a"].getRooms().then((function(t){e.rooms=t.data})).catch((function(e){console.log("getRooms err :",e)})),e.$store.dispatch("getUserId").then((function(){return x["a"].getUserDetail(e.$store.state.user_id)})).then((function(t){e.user=t.data})).catch((function(e){console.log("getRooms err :",e)})),x["a"].getRoomCategory().then((function(t){console.log("[Warning]: 目前有成功拿到資料但是沒有寫入",t.data),e.sideBarList=e.imageList.map((function(e){return e.value}))})).catch((function(e){console.log("getRoomCategory err :",e)})),x["a"].getRoomType().then((function(t){e.roomTypeDict=t.data})).catch((function(e){console.log("getRoomType err :",e)})),x["a"].getUserRooms().then((function(t){e.userRooms=t.data})).catch((function(e){console.log(e)})),e.$emit("wsConnStart",!0)})).catch((function(t){console.log("[Home.vue.created.catch], token exist but:","\nstatus code: ",t.response.status,"\nerror message: ",JSON.stringify(t.response.data)),"code"in t.response.data&&"token_not_valid"==t.response.data["code"]&&(console.log("[Home.vue.created.catch] delete token"),e.$store.dispatch("resetToken")),e.$router.push({name:"login"})})):(console.log("plz login !"),this.$message.error("請登入 !"),this.$router.push({name:"login"}))},methods:{joinRoom:function(){var e=this;console.log("exec join room"),this.$store.state.token&&this.$store.dispatch("refreshToken",this.event).then((function(t){return console.log(t.data.access),x["a"].postJoinRoom(e.dialogFormRoom.id,e.user.nickname)})).then((function(t){console.log("[Success]: 已加入房間",t.data),e.$router.push({name:"room-show",params:{id:e.dialogFormRoom.id}})})).catch((function(t){var o=t.data["error"];"You are already in the room."==o&&e.$router.push({name:"room-show",params:{id:e.dialogFormRoom.id}}),e.$message.error(t.data["error"])}))},updateFilter:function(e){this.filter=e},updateClickedRoom:function(e){var t=this.userRooms.map((function(e){return e.id}));t.includes(e["clickedRoomId"])?this.$router.push({name:"room-show",params:{id:e["clickedRoomId"]}}):(this.dialogFormVisible=e["dialogFormVisible"],this.dialogFormRoom=e["dialogFormRoom"])}}};o("f4d2");$.render=d,$.__scopeId="data-v-139dc7c4";var C=$,V=(o("a4d3"),o("e01a"),Object(r["fb"])("data-v-5f43c837"));Object(r["G"])("data-v-5f43c837");var L=Object(r["l"])("點我登入"),I=Object(r["m"])("h1",null,"Create an Room",-1),D=Object(r["l"])("-"),S=Object(r["m"])("span",null,"簡介",-1),P=Object(r["l"])("Create Room"),T=Object(r["l"])("Cancel");Object(r["E"])();var N=V((function(e,t,o,n,a,i){var c=Object(r["M"])("el-link"),s=Object(r["M"])("el-alert"),l=Object(r["M"])("el-input"),u=Object(r["M"])("el-form-item"),m=Object(r["M"])("el-option"),d=Object(r["M"])("el-select"),b=Object(r["M"])("el-date-picker"),f=Object(r["M"])("el-col"),p=Object(r["M"])("el-time-picker"),g=Object(r["M"])("el-radio"),h=Object(r["M"])("el-radio-group"),j=Object(r["M"])("el-slider"),O=Object(r["M"])("el-autocomplete"),v=Object(r["M"])("el-button"),_=Object(r["M"])("el-form"),y=Object(r["M"])("el-container");return Object(r["D"])(),Object(r["i"])("div",null,[Object(r["m"])(y,{class:"create-form"},{default:V((function(){return[Object(r["m"])(_,{ref:"form",model:a.room,"label-width":"80px",onSubmit:t[12]||(t[12]=Object(r["eb"])((function(){}),["prevent"]))},{default:V((function(){return[e.isAuth?Object(r["j"])("",!0):(Object(r["D"])(),Object(r["i"])(s,{key:0,title:"您尚未登入，登入後才能建立房間。",type:"warning","show-icon":""},{default:V((function(){return[Object(r["m"])(c,{href:"/login",type:"primary"},{default:V((function(){return[L]})),_:1})]})),_:1})),I,Object(r["m"])(u,{prop:"title",label:"房間標題",rules:a.notNullrule},{default:V((function(){return[Object(r["m"])(l,{modelValue:a.room.title,"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.room.title=e}),placeholder:"請填入房間標題"},null,8,["modelValue"])]})),_:1},8,["rules"]),Object(r["m"])(u,{label:"您的暱稱",prop:"nickname",rules:a.notNullrule},{default:V((function(){return[Object(r["m"])(l,{modelValue:a.room.nickname,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.room.nickname=e}),placeholder:"請填入暱稱"},null,8,["modelValue"])]})),_:1},8,["rules"]),Object(r["m"])(u,{label:"房間分類",prop:"category",rules:a.notNullrule},{default:V((function(){return[Object(r["m"])(d,{modelValue:a.room.category,"onUpdate:modelValue":t[3]||(t[3]=function(e){return a.room.category=e}),placeholder:"choose category",onChange:a.renderUrl},{default:V((function(){return[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(a.imageList,(function(e){return Object(r["D"])(),Object(r["i"])(m,{label:e.value,key:e.category,value:e.category},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","onChange"])]})),_:1},8,["rules"]),Object(r["m"])(u,{label:"關房時間"},{default:V((function(){return[Object(r["m"])(f,{span:11},{default:V((function(){return[Object(r["m"])(b,{type:"date",placeholder:"Choose Date",modelValue:a.room.date1,"onUpdate:modelValue":t[4]||(t[4]=function(e){return a.room.date1=e}),style:{width:"100%"}},null,8,["modelValue"])]})),_:1}),Object(r["m"])(f,{class:"line",span:2},{default:V((function(){return[D]})),_:1}),Object(r["m"])(f,{span:11},{default:V((function(){return[Object(r["m"])(p,{placeholder:"Choose Time",modelValue:a.room.date2,"onUpdate:modelValue":t[5]||(t[5]=function(e){return a.room.date2=e}),style:{width:"100%"}},null,8,["modelValue"])]})),_:1})]})),_:1}),Object(r["m"])(u,{label:"房間類型"},{default:V((function(){return[Object(r["m"])(h,{modelValue:a.room.type,"onUpdate:modelValue":t[6]||(t[6]=function(e){return a.room.type=e})},{default:V((function(){return[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(a.roomTypeDict,(function(e,t){return Object(r["D"])(),Object(r["i"])(g,{label:t,key:t},{default:V((function(){return[Object(r["l"])(Object(r["Q"])(e),1)]})),_:2},1032,["label"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),Object(r["m"])(u,{label:"最大人數",onSubmit:t[8]||(t[8]=Object(r["eb"])((function(){}),["prevent"]))},{default:V((function(){return[Object(r["m"])(j,{modelValue:a.room.capacity,"onUpdate:modelValue":t[7]||(t[7]=function(e){return a.room.capacity=e}),"show-input":"",max:100,step:5},null,8,["modelValue"])]})),_:1}),Object(r["m"])(u,{prop:"description",rules:a.notNullrule},{label:V((function(){return[S]})),default:V((function(){return[Object(r["m"])(l,{type:"textarea",placeholder:"Enter description of your room:",modelValue:a.room.description,"onUpdate:modelValue":t[9]||(t[9]=function(e){return a.room.description=e}),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]})),_:1},8,["rules"]),Object(r["m"])(u,{label:"封面照片"},{default:V((function(){return[Object(r["m"])(O,{class:"inline-input",modelValue:a.selectedImageCate,"onUpdate:modelValue":t[10]||(t[10]=function(e){return a.selectedImageCate=e}),"fetch-suggestions":a.querySearch,placeholder:"請輸入內容",onSelect:a.handleSelect},null,8,["modelValue","fetch-suggestions","onSelect"]),Object(r["m"])(l,{modelValue:a.room.image_url,"onUpdate:modelValue":t[11]||(t[11]=function(e){return a.room.image_url=e}),placeholder:"可放可不放，建議上傳 imgur 並複製圖片網址(.jpg 或 .png 結尾)",clearable:""},null,8,["modelValue"])]})),_:1}),Object(r["m"])(u,null,{default:V((function(){return[Object(r["m"])(v,{type:"primary",onClick:i.createRoom,loading:a.loading},{default:V((function(){return[P]})),_:1},8,["onClick","loading"]),Object(r["m"])(v,null,{default:V((function(){return[T]})),_:1})]})),_:1})]})),_:1},8,["model"])]})),_:1})])})),U=o("3835"),F=(o("b64b"),o("4fad"),{components:null,data:function(){var e=this,t={course:"課程討論",find_group:"尋求組隊"},o={public:"公開",private:"私人",lesson:"課程"},n=[{value:"自定義",url:"",category:""},{value:"課程討論",url:"https://i.imgur.com/GIiSOLM.jpg",category:"course"},{value:"吃飯",url:"https://i.imgur.com/kN4J0UL.jpg",category:"eating"},{value:"爬山",url:"https://i.imgur.com/17SSeJb.png",category:"hiking"},{value:"打籃球",url:"https://i.imgur.com/o2uS5WX.png",category:"baseketball"},{value:"打 Apex",url:"https://i.imgur.com/PkZu9rV.jpg",category:"apex"},{value:"玩 Switch 遊戲",url:"https://i.imgur.com/16C4zzd.png",category:"switch"},{value:"跑步",url:"https://i.imgur.com/wc0HqRT.png",category:"running"},{value:"團購",url:"https://i.imgur.com/hcP3JA2.png",category:"group_buying"},{value:"逛街",url:"https://i.imgur.com/85zF3RK.jpg",category:"shopping"},{value:"打遊戲",url:"https://i.imgur.com/ex5uIMF.jpg",category:"game"},{value:"買衣服",url:"https://i.imgur.com/UElotjt.jpg",category:"clothing"},{value:"麥當勞",url:"https://i.imgur.com/Ll9w1eq.png",category:"mc"},{value:"肯德基",url:"https://i.imgur.com/NBt3Xka.jpg",category:"kfc"},{value:"看電影",url:"https://i.imgur.com/QzZKggo.png",category:"moive"},{value:"演唱會",url:"https://i.imgur.com/NBt3Xka.jpg",category:"live"},{value:"打桌球",url:"https://i.imgur.com/kluQV3e.jpg",category:"tabletennis"},{value:"讀書",url:"https://i.imgur.com/jneYUkV.jpg",category:"study"},{value:"讀書會",url:"https://i.imgur.com/rM3O9xh.png",category:"studyclub"},{value:"看比賽",url:"https://i.imgur.com/Yya0Www.png",category:"race"}],r=function(e,t){var o=e?n.filter(a(e)):n;console.log("results:",o),t(o)},a=function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},i=function(t){e.room.image_url=t.url},c=function(t){var o=e.imageList.find((function(e){return e.category==t}));o&&(e.room.image_url=o.url,e.selectedImageCate=o.value)};return{categoryDict:t,roomTypeDict:o,imageList:n,querySearch:r,createFilter:a,handleSelect:i,renderUrl:c,loading:!1,selectedImageCate:"",notNullrule:{required:!0,message:"不能為空",trigger:"blur"},room:{title:"",nickname:"房主",capacity:10,category:"",date1:new Date,date2:new Date((new Date).setHours(23,59,59)),invite:!1,tag:[],type:"public",description:"",image_url:""}}},created:function(){var e=this;this.$store.state.token||(console.log("plz login !"),this.$router.push({name:"login"})),this.$store.state.token&&!this.$store.state.is_verify&&this.$store.dispatch("getIsVerify").then((function(){0==e.$store.state.is_verify&&(e.$router.push({name:"profile"}),e.$message.error("未過 mail 認證 !"))}))},methods:{hardcreateRoom:function(){var e=this;this.$store.state.token?this.$store.dispatch("refreshToken").then((function(t){return console.log("resRefresh token:",t.data),e.loading=!0,x["a"].postRoom(e.room)})).then((function(t){201==t.status&&console.log(t.statusText),e.$message.success(t.statusText),e.loading=!1})).catch((function(t){console.log("[Warning ! 401 401 401 !]"),e.loading=!1,console.log("[RoomCreate.vue.created.catch], token exist but:","\nstatus code: ",t.response.status,"\nerror message: ",JSON.stringify(t.response.data)),"code"in t.response.data&&"token_not_valid"==t.response.data["code"]&&(console.log("[RoomCreate.vue.createRoom.catch] delete token"),e.$store.dispatch("resetToken"),e.$router.push({name:"login"})),e.$message.error(JSON.stringify(t.response.data))})):(console.log("plz login !"),this.$router.push({name:"login"}))},createRoom:function(){var e=this;if(this.$store.state.token)return this.$store.dispatch("refreshToken").then((function(t){return 200!=t.status?Promise.reject("refresh token err"):(e.loading=!0,x["a"].postRoom(e.room))})).then((function(t){console.log("res in CreateRoom:",t),e.$message.success(t.statusText),e.loading=!1,e.$router.push({name:"room-show",params:{id:t.data.id}})})).catch((function(t){console.log("err in CreateRoom:",t.data,Object.keys(t.data));for(var o=0,n=Object.entries(t.data);o<n.length;o++){var r=Object(U["a"])(n[o],2),a=r[0],i=r[1];e.$message.error(a+": "+i[0])}e.loading=!1}));console.log("plz login !"),this.$router.push({name:"login"})}},computed:Object(b["a"])({},Object(M["b"])(["isAuth"]))});o("469f");F.render=N,F.__scopeId="data-v-5f43c837";var E=F,B=Object(r["fb"])("data-v-e185418c");Object(r["G"])("data-v-e185418c");var Q={class:"title"},W=Object(r["m"])("h5",null,"房主",-1),A=Object(r["m"])("h5",null,"房間開放時間",-1),q=Object(r["m"])("br",null,null,-1),z=Object(r["l"])(" 房間簡介"),K=Object(r["m"])("h5",null,"分類",-1),J=Object(r["l"])(" 成員列表"),G={class:"username"},H=Object(r["l"])(" 限制人數 "),X=Object(r["m"])("h5",null,"測試 input",-1),Y=Object(r["m"])("h5",null,"離開房間",-1),Z=Object(r["l"])("離開房間"),ee=Object(r["m"])("span",null,"最大人數",-1),te={class:"dialog-footer"},oe=Object(r["l"])("取消"),ne=Object(r["l"])("送出"),re=Object(r["m"])("h3",null,"成員列表",-1),ae=Object(r["l"])("踢出房間"),ie=Object(r["l"])("封鎖"),ce=Object(r["l"])("將房主轉移給他"),se=Object(r["m"])("h3",null,"Block 列表",-1),le=Object(r["l"])("解除封鎖"),ue=Object(r["m"])("h3",null,"邀請列表",-1),me=Object(r["l"])("邀請"),de={class:"dialog-footer"},be=Object(r["l"])("關閉"),fe=Object(r["m"])("h3",null,"Room Record",-1),pe=Object(r["m"])("br",null,null,-1),ge=Object(r["l"])("返回"),he=Object(r["m"])("span",{class:"dialog-footer"},null,-1);Object(r["E"])();var je=B((function(e,t,o,n,a,i){var c=Object(r["M"])("SideBar"),s=Object(r["M"])("el-aside"),l=Object(r["M"])("ChatRoom"),u=Object(r["M"])("el-main"),m=Object(r["M"])("el-divider"),d=Object(r["M"])("el-button"),b=Object(r["M"])("el-avatar"),f=Object(r["M"])("el-input"),p=Object(r["M"])("el-popconfirm"),g=Object(r["M"])("el-scrollbar"),h=Object(r["M"])("el-container"),j=Object(r["M"])("el-form-item"),O=Object(r["M"])("el-option"),v=Object(r["M"])("el-select"),_=Object(r["M"])("el-slider"),y=Object(r["M"])("el-form"),k=Object(r["M"])("el-dialog"),w=Object(r["M"])("el-table-column"),R=Object(r["M"])("el-table"),x=Object(r["M"])("el-result");return Object(r["D"])(),Object(r["i"])(r["b"],null,[Object(r["m"])(h,{class:"mainContainer"},{default:B((function(){return[Object(r["m"])(s,{class:"SideBarContainer"},{default:B((function(){return[Object(r["m"])(c,{sideBarList:a.userRooms.map((function(e){return{text:e.title,url:"/room/"+e.id+"/"}})),urlMode:!0},null,8,["sideBarList"])]})),_:1}),Object(r["m"])(u,{class:"chatRoomContainer"},{default:B((function(){return[Object(r["m"])(l,{roomws:a.roomws,messages:a.messages,onAddMessage:i.addMessage},null,8,["roomws","messages","onAddMessage"])]})),_:1}),Object(r["m"])(s,{class:"roomInfo"},{default:B((function(){return[Object(r["m"])(g,null,{default:B((function(){return[Object(r["m"])("h5",Q,Object(r["Q"])(a.room.title),1),Object(r["m"])(m),Object(r["m"])("div",null,[W,Object(r["m"])("p",null,Object(r["Q"])(a.host?a.host:""),1)]),Object(r["m"])(m),Object(r["m"])("div",null,[A,Object(r["m"])("p",null,[Object(r["l"])(Object(r["Q"])(a.room.create_time?a.room.create_time.slice(0,10):"未指定")+" "+Object(r["Q"])(a.room.create_time?a.room.create_time.slice(11,19):"")+" ~",1),q,Object(r["l"])(" "+Object(r["Q"])(a.room.valid_time?a.room.valid_time.slice(0,10):"未指定")+" "+Object(r["Q"])(a.room.valid_time?a.room.valid_time.slice(11,19):""),1)])]),Object(r["m"])(m),Object(r["m"])("div",null,[Object(r["m"])("h5",null,[z,Object(r["m"])("i",{class:"el-icon-edit el-input__icon",onClick:t[1]||(t[1]=function(e){return a.dialogFormVisible=!0})})]),Object(r["m"])("p",null,Object(r["Q"])(a.room.introduction),1)]),Object(r["m"])(m),Object(r["m"])("div",null,[K,Object(r["m"])(d,{size:"mini",round:""},{default:B((function(){return[Object(r["l"])(Object(r["Q"])(a.room.room_category),1)]})),_:1})]),Object(r["m"])(m),Object(r["m"])("div",null,[Object(r["m"])("h5",null,[J,Object(r["m"])("i",{class:"el-icon-edit el-input__icon",onClick:t[2]||(t[2]=function(e){return a.memberFormVisible=!0})})]),(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(a.memberList,(function(e){return Object(r["D"])(),Object(r["i"])("div",{class:"member",key:e.member_id},[Object(r["m"])(b,{size:"small",icon:"el-icon-user-solid"}),Object(r["m"])("p",G,Object(r["Q"])(e.nickname),1)])})),128))]),Object(r["m"])(m),Object(r["m"])("div",null,[Object(r["m"])("h5",null,[H,Object(r["m"])("i",{class:"el-icon-edit el-input__icon",onClick:t[3]||(t[3]=function(){return e.handleIconClick&&e.handleIconClick.apply(e,arguments)})})]),Object(r["m"])("p",null,Object(r["Q"])("lesson"==a.room.room_type?"無限制":a.room.people_limit),1)]),Object(r["m"])(m),Object(r["m"])("div",null,[X,Object(r["m"])(f,{placeholder:"請輸入內容",clearable:""},{suffix:B((function(){return[Object(r["m"])("i",{class:"el-icon-edit el-input__icon",onClick:t[4]||(t[4]=function(){return e.handleIconClick&&e.handleIconClick.apply(e,arguments)})})]})),_:1})]),Object(r["m"])(m),Object(r["m"])("div",null,[Y,Object(r["m"])(p,{confirmButtonText:"離開",confirmButtonType:"danger",cancelButtonText:"取消",icon:"el-icon-info",iconColor:"red",title:"確定離開 ? 離開後將不會是成員。若您是'房主'會直接刪除房間。",onConfirm:i.handleExitRoom},{reference:B((function(){return[Object(r["m"])(d,{type:"danger",round:""},{default:B((function(){return[Z]})),_:1})]})),_:1},8,["onConfirm"])])]})),_:1})]})),_:1})]})),_:1}),a.isAdmin?(Object(r["D"])(),Object(r["i"])(k,{key:0,title:"編輯房間",modelValue:a.dialogFormVisible,"onUpdate:modelValue":t[12]||(t[12]=function(e){return a.dialogFormVisible=e})},{footer:B((function(){return[Object(r["m"])("span",te,[Object(r["m"])(d,{onClick:t[10]||(t[10]=function(e){return a.dialogFormVisible=!1})},{default:B((function(){return[oe]})),_:1}),Object(r["m"])(d,{type:"primary",onClick:t[11]||(t[11]=function(e){i.handleEditRoom(),a.dialogFormVisible=!1})},{default:B((function(){return[ne]})),_:1})])]})),default:B((function(){return[Object(r["m"])(y,{model:a.dialogFormRoom},{default:B((function(){return[Object(r["m"])(j,{label:"房間名稱"},{default:B((function(){return[Object(r["m"])(f,{modelValue:a.dialogFormRoom.title,"onUpdate:modelValue":t[5]||(t[5]=function(e){return a.dialogFormRoom.title=e})},null,8,["modelValue"])]})),_:1}),Object(r["m"])(j,{label:"房間 Category"},{default:B((function(){return[Object(r["m"])(v,{modelValue:a.dialogFormRoom.room_category,"onUpdate:modelValue":t[6]||(t[6]=function(e){return a.dialogFormRoom.room_category=e}),placeholder:"選擇房間分類"},{default:B((function(){return[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(a.categoryDict,(function(e,t){return Object(r["D"])(),Object(r["i"])(O,{label:e,key:e,value:t},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),Object(r["m"])(j,{label:"簡介"},{default:B((function(){return[Object(r["m"])(f,{type:"textarea",placeholder:"Enter description of your room:",modelValue:a.dialogFormRoom.introduction,"onUpdate:modelValue":t[7]||(t[7]=function(e){return a.dialogFormRoom.introduction=e}),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]})),_:1}),Object(r["m"])(j,{onSubmit:t[9]||(t[9]=Object(r["eb"])((function(){}),["prevent"]))},{default:B((function(){return[ee,Object(r["m"])(_,{modelValue:a.dialogFormRoom.people_limit,"onUpdate:modelValue":t[8]||(t[8]=function(e){return a.dialogFormRoom.people_limit=e}),"show-input":"",max:100,step:5,"input-size":"mini"},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model"])]})),_:1},8,["modelValue"])):Object(r["j"])("",!0),Object(r["m"])(k,{modelValue:a.memberFormVisible,"onUpdate:modelValue":t[16]||(t[16]=function(e){return a.memberFormVisible=e})},{footer:B((function(){return[Object(r["m"])("span",de,[Object(r["m"])(d,{type:"primary",onClick:t[15]||(t[15]=function(e){return a.memberFormVisible=!1})},{default:B((function(){return[be]})),_:1})])]})),default:B((function(){return[re,Object(r["m"])(R,{data:a.memberList,style:{width:"100%"}},{default:B((function(){return[Object(r["m"])(w,{type:"expand"},{default:B((function(e){return[Object(r["m"])(y,{"label-position":"left",inline:"",class:"demo-table-expand"},{default:B((function(){return[Object(r["m"])(j,{label:"學號"},{default:B((function(){return[Object(r["m"])("span",null,Object(r["Q"])(e.row.username),1)]})),_:2},1024),Object(r["m"])(j,{label:"暱稱"},{default:B((function(){return[Object(r["m"])("span",null,Object(r["Q"])(e.row.nickname),1)]})),_:2},1024),a.isAdmin&&a.user.member_id!=e.row.member_id&&e.row.member_id!=a.memberList.find((function(e){return"admin"==e.access_level})).member_id?(Object(r["D"])(),Object(r["i"])(j,{key:0,label:"操作"},{default:B((function(){return[Object(r["m"])(d,{size:"mini",type:"warning",plain:"",onClick:function(t){return i.handleMemberOperation(e.$index,e.row,"remove")}},{default:B((function(){return[ae]})),_:2},1032,["onClick"]),Object(r["m"])(d,{size:"mini",type:"danger",onClick:function(t){return i.handleMemberOperation(e.$index,e.row,"block")}},{default:B((function(){return[ie]})),_:2},1032,["onClick"]),Object(r["m"])(p,{confirmButtonText:"確認",cancelButtonText:"取消",icon:"el-icon-info",iconColor:"red",title:"確定轉移房主身分給他 ? 您將降級為無權限用戶。",onConfirm:function(t){return i.handleTransferAdmin(e.row)}},{reference:B((function(){return[Object(r["m"])(d,{size:"mini",type:"danger",plain:""},{default:B((function(){return[ce]})),_:1})]})),_:2},1032,["onConfirm"])]})),_:2},1024)):Object(r["j"])("",!0),a.isAdmin&&a.user.member_id!=e.row.member_id&&e.row.member_id!=a.memberList.find((function(e){return"admin"==e.access_level})).member_id?(Object(r["D"])(),Object(r["i"])(j,{key:1,label:"更改階級成:"},{default:B((function(){return[Object(r["m"])(v,{modelValue:a.tmp,"onUpdate:modelValue":t[13]||(t[13]=function(e){return a.tmp=e}),onChange:function(t){return i.handleSetLevel(t,e.row.member_id)}},{default:B((function(){return[(Object(r["D"])(),Object(r["i"])(r["b"],null,Object(r["K"])({manager:"房管",user:"普通用戶"},(function(e,t){return Object(r["m"])(O,{key:t,label:e,value:t},null,8,["label","value"])})),64))]})),_:2},1032,["modelValue","onChange"])]})),_:2},1024)):Object(r["j"])("",!0)]})),_:2},1024)]})),_:1}),Object(r["m"])(w,{label:"學號",prop:"username"}),Object(r["m"])(w,{label:"暱稱",prop:"nickname"}),Object(r["m"])(w,{label:"階級",prop:"access_level"})]})),_:1},8,["data"]),se,Object(r["m"])(R,{data:a.blockList,style:{width:"100%"}},{default:B((function(){return[Object(r["m"])(w,{type:"expand"},{default:B((function(e){return[Object(r["m"])(y,{"label-position":"left",inline:"",class:"demo-table-expand"},{default:B((function(){return[Object(r["m"])(j,{label:"操作者"},{default:B((function(){return[Object(r["m"])("span",null,Object(r["Q"])(a.memberList.filter((function(t){return t.member_id==e.row.block_manager_id}))[0].nickname+"("+e.row.manager_username+")"),1)]})),_:2},1024),a.isAdmin?(Object(r["D"])(),Object(r["i"])(j,{key:0,label:"操作"},{default:B((function(){return[Object(r["m"])(p,{confirmButtonText:"確認",cancelButtonText:"取消",icon:"el-icon-info",iconColor:"red",title:"確定解除封鎖 ?",onConfirm:function(t){return i.handleUnblockOperation(e.row)}},{reference:B((function(){return[Object(r["m"])(d,{size:"mini",type:"danger"},{default:B((function(){return[le]})),_:1})]})),_:2},1032,["onConfirm"])]})),_:2},1024)):Object(r["j"])("",!0)]})),_:2},1024)]})),_:1}),Object(r["m"])(w,{prop:"user_username",label:"學號"}),Object(r["m"])(w,{prop:"reason",label:"原因"})]})),_:1},8,["data"]),ue,Object(r["m"])(y,{inline:!0,class:"demo-form-inline"},{default:B((function(){return[Object(r["m"])(j,{label:"請輸入欲邀請學號"},{default:B((function(){return[Object(r["m"])(f,{modelValue:a.invitedUserId,"onUpdate:modelValue":t[14]||(t[14]=function(e){return a.invitedUserId=e}),placeholder:"學號"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(j,null,{default:B((function(){return[Object(r["m"])(d,{type:"primary",onClick:i.handleInvitation},{default:B((function(){return[me]})),_:1},8,["onClick"])]})),_:1})]})),_:1}),Object(r["m"])(R,{data:a.invitationList,style:{width:"100%"}},{default:B((function(){return[Object(r["m"])(w,{prop:"invited_username",label:"被邀請者"}),Object(r["m"])(w,{prop:"inviter_username",label:"邀請者"})]})),_:1},8,["data"]),fe,Object(r["m"])("div",null,[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(a.roomRecord.slice(a.roomRecord.length-5,a.roomRecord.length),(function(e){return Object(r["D"])(),Object(r["i"])("span",{key:e},[Object(r["l"])(Object(r["Q"])(e.recording),1),pe])})),128))])]})),_:1},8,["modelValue"]),Object(r["m"])(k,{title:"提示",modelValue:a.removeDialog.visible,"onUpdate:modelValue":t[17]||(t[17]=function(e){return a.removeDialog.visible=e}),width:"30%","before-close":e.handleClose},{footer:B((function(){return[he]})),default:B((function(){return[Object(r["m"])(x,{icon:"warning",title:a.removeDialog.title,subTitle:a.removeDialog.subTitle},{extra:B((function(){return[Object(r["m"])(d,{type:"primary",size:"medium"},{default:B((function(){return[ge]})),_:1})]})),_:1},8,["title","subTitle"])]})),_:1},8,["modelValue","before-close"])],64)})),Oe=o("ade3"),ve=o("1da1"),_e=(o("96cf"),o("a9e3"),o("4d90"),o("99af"),{class:"messagesWrapper"}),ye={class:"inlineContainer own"},ke=Object(r["m"])("img",{class:"inlineIcon",src:"https://www.pinclipart.com/picdir/middle/205-2059398_blinkk-en-mac-app-store-ninja-icon-transparent.png"},null,-1),we={class:"ownBubble own"},Re={class:"own"},xe={class:"inlineContainer"},Me=Object(r["m"])("img",{class:"inlineIcon",src:"https://cdn1.iconfinder.com/data/icons/ninja-things-1/1772/ninja-simple-512.png"},null,-1),$e={class:"otherBubble other"},Ce={class:"other"};function Ve(e,t,o,n,a,i){var c=Object(r["M"])("el-scrollbar"),s=Object(r["M"])("el-input");return Object(r["D"])(),Object(r["i"])(r["b"],null,[Object(r["m"])(c,{class:"messageWrapperScrollBar"},{default:Object(r["bb"])((function(){return[Object(r["m"])("div",_e,[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(o.messages,(function(e,t){return Object(r["D"])(),Object(r["i"])("div",{key:t,class:"bubbleWrapper",ref:"messageRef"},[e.user===i.myID?(Object(r["D"])(),Object(r["i"])(r["b"],{key:0},[Object(r["m"])("div",ye,[ke,Object(r["m"])("div",we,Object(r["Q"])(e.text),1)]),Object(r["m"])("span",Re,Object(r["Q"])(e.time),1)],64)):(Object(r["D"])(),Object(r["i"])(r["b"],{key:1},[Object(r["m"])("div",xe,[Me,Object(r["m"])("div",$e,Object(r["Q"])(e.text),1)]),Object(r["m"])("span",Ce,Object(r["Q"])(e.time),1)],64))],512)})),128))])]})),_:1}),Object(r["m"])(s,{placeholder:"輸入訊息",modelValue:a.message,"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.message=e}),onKeydown:i.addMessage,class:"messageInput"},null,8,["modelValue","onKeydown"])],64)}var Le={props:["roomws","messages"],computed:{myID:function(){return this.$store.state.user_id}},data:function(){return{message:"",sendMessage:""}},methods:{addMessage:function(e){if("Enter"===e.key&&this.message){var t=new Date,o=t.getHours(),n=t.getMinutes();o=String(o).padStart(2,"0"),n=String(n).padStart(2,"0");var r="".concat(o,":").concat(n),a={user:this.$store.state.user_id,text:this.message,time:r};this.$emit("addMessasge",a);var i=parseInt(this.$route.params.id,10),c={header:"message",msg_type:"text",userID:this.$store.state.user_id,roomID:i,message:this.message,token:this.$store.state.token};this.roomws[i].send(JSON.stringify(c)),this.message=""}}},watch:{messages:{immediate:!0,deep:!0,handler:function(){this.$nextTick((function(){var e=this.$refs.messageRef;e&&e.scrollIntoView(!1,{behavior:"smooth"})}))}}}};o("2303");Le.render=Ve;var Ie=Le,De=o("32b9"),Se={props:["id"],components:{SideBar:R,ChatRoom:Ie},data:function(){return{exist_btn_text:"離開房間",tmp:"",invitedUserId:"",user:{access_level:"user"},memberList:[],invitationList:[],blockList:[],categoryDict:{},userRooms:[],levelDict:{admin:"房主",manager:"房管",user:"普通用戶"},host:"",roomRecord:"",dialogFormVisible:!1,isAdmin:!1,room:{id:0,title:"Loading Not Successful",introduction:"Loading Not Successful",create_time:"2000-01-01T20:33:33.033448+08:00",valid_time:"2000-01-01T20:33:33.033448+08:00",room_type:"private",room_category:"course",people_limit:1},tableData:[{date:"2010-01-01",name:"",address:""}],dialogFormRoom:{},memberFormVisible:!1,roomws:{},messages:[],removeDialog:{visible:!1,title:"",subTitle:""}}},created:function(){var e=this;return Object(ve["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.state.token&&!e.$store.state.is_verify&&e.$store.dispatch("getIsVerify").then((function(){console.log("未過 mail 認證 !"),0==e.$store.state.is_verify&&(e.$router.push({name:"profile"}),e.$message.error("未過 mail 認證 !"))})),e.$store.state.token?e.$store.dispatch("refreshToken").then((function(t){return console.log(t),e.getUserRooms()})).then((function(t){return t.data.map((function(e){return e.id})).includes(Number(e.id))?(e.userRooms=t.data,e.init_list()):(e.$message.error("你怎麼進來的 = ="),e.removeDialog.title="您將被導向首頁",e.removeDialog.subTitle="原因: 房間不存在/您無權限訪問",e.removeDialog.visible=!0,setTimeout((function(){e.$router.push({name:"home"})}),2e3),Promise.reject("user not in room !"))})).catch((function(e){console.log(e)})):(e.$message.error("請登入 !"),e.$router.push({name:"login"})),null==e.roomws[parseInt(e.$route.params.id,10)]&&(console.log("this.roomws[this.$route.params.id] == null"),o=parseInt(e.$route.params.id,10),e.roomws[o]=De["a"].InitRoomWebsocket(e.$store.state.token,e.$route.params.id),console.log(e.roomws[o]),e.roomws[o].onmessage=function(t){var n=JSON.parse(t.data),r=null;switch(console.log("[Websocket event.data]:",t.data),n.header){case"message":r=new Date(n.time);var a=r.getHours(),i=r.getMinutes();a=String(a).padStart(2,"0"),i=String(i).padStart(2,"0");var c="".concat(a,":").concat(i),s={user:n.userID,text:n.message,time:c};e.messages.push(s);break;case"remove":if("Removed"===n.message){console.log("ws case : remove");var l={header:"controlMessage",msg_type:"text",userID:e.$store.state.user_id,roomID:parseInt(e.$route.params.id,10),message:"Close",token:e.$store.state.token};e.roomws[o].send(JSON.stringify(l)),e.removeDialog.title="您將被導向首頁",e.removeDialog.subTitle="原因: 您被移出成員列表。",e.removeDialog.visible=!0,setTimeout((function(){e.$router.push({name:"home"})}),3e3)}break;case"update":if(n.message.includes("member_list")&&e.getMemberList().then((function(t){e.memberList=t.data,e.host=t.data.filter((function(e){return"admin"==e.access_level}))[0].nickname,t.data.filter((function(e){return e.member_id}))||console.log("you are not in room QQ")})).catch((function(e){console.log(e.data)})),n.message.includes("block_list")&&e.getBlockList().then((function(t){e.blockList=t.data,console.log("blockList:",t.data)})).catch((function(e){console.log(e.data)})),n.message.includes("invite_list")&&e.getInvitationList().then((function(t){e.invitationList=t.data,console.log("invitationList",t.data)})).catch((function(e){console.log(e.data)})),n.message.includes("profile")&&e.getRoomObj().then((function(t){e.room=t,e.dialogFormRoom=Object(b["a"])({},t),console.log(t)})).catch((function(e){console.log(e)})),"delete_room"===n.message){var u={header:"controlMessage",msg_type:"text",userID:e.$store.state.user_id,roomID:parseInt(e.$route.params.id,10),message:"Close",token:e.$store.state.token};e.roomws[o].send(JSON.stringify(u)),e.removeDialog.title="您將被導向首頁",e.removeDialog.subTitle="原因: 房主關閉了房間。",e.removeDialog.visible=!0,setTimeout((function(){e.$router.push({name:"home"})}),3e3)}break;case"ping":e.$route.fullPath!="/room/"+o&&e.roomws[o].close();break}});case 3:case"end":return t.stop()}}),t)})))()},methods:{init_list:function(){var e=this;this.getRoomObj().then((function(t){e.room=t,e.dialogFormRoom=Object(b["a"])({},t),console.log(t)})).catch((function(e){console.log(e)})),this.getInvitationList().then((function(t){e.invitationList=t.data,console.log("invitationList",t.data)})).catch((function(e){console.log(e.data)})),this.getMemberList().then((function(t){return e.memberList=t.data,e.host=t.data.filter((function(e){return"admin"==e.access_level}))[0].nickname,console.log("memberList: ",t.data),e.getUserObj()})).catch((function(e){console.log(e.data)})),this.getBlockList().then((function(t){e.blockList=t.data,console.log("blockList:",t.data)})).catch((function(e){console.log(e.data)})),this.getInvitationList().then((function(t){e.invitationList=t.data,console.log("invitationList:",t.data)})).catch((function(e){console.log(e.data)})),this.getRoomRecord().then((function(t){e.roomRecord=t.data,console.log("roomRecord:",t.data)})).catch((function(e){console.log(e.data)})),this.getRoomCategory().then((function(t){e.categoryDict=t.data,console.log("categoryDict:",t.data)})).catch((function(e){console.log(e.data)}))},getUserObj:function(){var e=this;x["a"].getUserId().then((function(t){var o=t.data.id,n=e.memberList.filter((function(e){return e.member_id==o}))[0];n&&(e.user=n)})).catch((function(e){return Promise.reject(e)}))},getRoomObj:function(){var e=this;return new Promise((function(t,o){x["a"].getRoom(e.id).then((function(e){t(e.data)})).catch((function(e){console.log("There was an error:",JSON.stringify(e.response)),o(e.data)}))}))},getMemberList:function(){return x["a"].getRoomMemberList(this.id)},getBlockList:function(){return x["a"].getRoomBlockList(this.id)},getInvitationList:function(){return x["a"].getRoomInvitationList(this.id)},getRoomRecord:function(){return x["a"].getRoomRecord(this.id)},getRoomCategory:function(){return x["a"].getRoomCategory()},getUserRooms:function(){return x["a"].getUserRooms()},handleEditRoom:function(){var e=this;x["a"].putRoom(this.id,this.dialogFormRoom).then((function(t){console.log("[Success] 成功修改房間，成果:",t.data),e.room=t.data})).catch((function(e){console.log(e)}))},handleExitRoom:function(){var e=this;"admin"==this.user.access_level?x["a"].deleteRoom(this.id).catch((function(t){e.$message.error(t.data.error)})):x["a"].deleteLeaveRoom(this.id).catch((function(t){e.$message.error(t.data.error)})),this.$router.push({name:"home"})},handleInvitation:function(){var e=this;x["a"].postRoomInvite(this.id,this.invitedUserId).then((function(){return console.log("postRoomInvite Successful"),e.getInvitationList()})).then((function(t){e.invitationList=t.data})).catch((function(t){e.$message.error(t.data.error)}))},handleCancelInvitation:function(e){console.log(e.invited_id)},handleSetLevel:function(e,t){var o=this;x["a"].putSetLevel(this.id,Object(Oe["a"])({},t,e)).then((function(){return o.getMemberList()})).then((function(n){o.memberList=n.data,console.log("[Success]",t,"的階級改成",e),o.$message.success("修改階級成功 !")})).catch((function(e){o.$message.error("handleSetLevel:",e.data.error)}))},handleAddModerator:function(e){var t={};t[e.member_id]="",console.log(t)},handleTransferAdmin:function(e){x["a"].putTransferAdmin(this.id,e.member_id).then((function(){console.log("已轉移房主")})).catch((function(e){console.log(e)}))},handleUnblockOperation:function(e){var t=this;x["a"].deleteUnblockUser(this.id,e.blocked_user_id).then((function(){console.log("[Success] 解除封鎖成功，對象:",e.blocked_user_id),t.blockList=t.blockList.filter((function(t){return t.blocked_user_id!=e.blocked_user_id}))})).catch((function(e){console.log(e)}))},handleMemberOperation:function(e,t,o){var n=this,r="block"==o?"封鎖":"踢出房間";this.$prompt("執行原因","將 "+t.nickname+" 踢出房間"+r,{confirmButtonText:"確定",cancelButtonText:"取消",inputPattern:/[^(?!\s*$).+]/,inputErrorMessage:"原因不能為空 !"}).then((function(e){return"block"==o?x["a"].postBlockUser(n.id,t.member_id,e.value):"remove"==o?x["a"].deleteRemoveUser(n.id,t.member_id,e.value):void 0})).then((function(e){if(200==e.status&&n.$message({type:"success",message:r+"成功"}),n.memberList=n.memberList.filter((function(e){return e.member_id!=t.member_id})),"block"==o)return n.getBlockList().then((function(e){n.blockList=e.data})).catch((function(e){console.log(e.data)}))})).catch((function(e){console.log("[In RoomShow]",e),"cancel"==e&&n.$message({type:"info",message:"取消操作"})})),console.log("[Success]: 執行",o,"操作成功，對象:",t.member_id)},addMessage:function(e){this.messages.push(e)}},watch:{memberList:function(e){this.getUserObj(),console.log("[watch] memberList changed:",e)},user:function(e){console.log("[watch] user changed:",e),this.isAdmin="admin"==e.access_level||"manager"==e.access_level}}};o("c1be");Se.render=je,Se.__scopeId="data-v-e185418c";var Pe=Se,Te=Object(r["fb"])("data-v-b77a4e62");Object(r["G"])("data-v-b77a4e62");var Ne={class:"login"},Ue=Object(r["m"])("h2",null,"Login",-1),Fe=Object(r["l"])("Login"),Ee=Object(r["m"])("a",{class:"forgot-password",href:""},"Forgot password ?",-1);Object(r["E"])();var Be=Te((function(e,t,o,n,a,i){var c=Object(r["M"])("el-input"),s=Object(r["M"])("el-form-item"),l=Object(r["M"])("el-button"),u=Object(r["M"])("el-form"),m=Object(r["M"])("el-card");return Object(r["D"])(),Object(r["i"])("div",Ne,[Object(r["m"])(m,{class:"login-card"},{default:Te((function(){return[Ue,Object(r["m"])(u,{class:"login-form",model:a.model,rules:a.rules,ref:"form",onSubmit:Object(r["eb"])(i.login,["prevent"])},{default:Te((function(){return[Object(r["m"])(s,{prop:"email"},{default:Te((function(){return[Object(r["m"])(c,{modelValue:a.model.email,"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.model.email=e}),placeholder:"Email","prefix-icon":"el-icon-user"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(s,{prop:"password"},{default:Te((function(){return[Object(r["m"])(c,{modelValue:a.model.password,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.model.password=e}),placeholder:"Password",type:"password","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(s,null,{default:Te((function(){return[Object(r["m"])(l,{loading:a.loading,class:"login-button",type:"primary","native-type":"submit",block:""},{default:Te((function(){return[Fe]})),_:1},8,["loading"])]})),_:1}),Ee]})),_:1},8,["model","rules","onSubmit"])]})),_:1})])})),Qe={data:function(){return{model:{email:"",password:""},loading:!1,rules:{email:[{required:!0,message:"Email is required",trigger:"blur"},{min:4,message:"Email length should be at least 4 characters",trigger:"blur"}],password:[{required:!0,message:"Password is required",trigger:"blur"},{min:4,message:"Password length should be at least 5 characters",trigger:"blur"}]}}},created:function(){this.forDev()},methods:{forDev:function(){this.model.email="test1@test.com",this.model.password="test1"},Login:function(){var e=this;this.$store.dispatch("login",this.model).then((function(){e.$message.success("Login successfull"),e.$router.go(-1)})).catch((function(t){console.log("Login Failed:",t),e.$message.error("Email or password is invalid")}))},simulateLogin:function(){return new Promise((function(e){setTimeout(e,800)}))},login:function(){var e=this;return Object(ve["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.form.validate();case 2:if(o=t.sent,o){t.next=5;break}return t.abrupt("return");case 5:return e.loading=!0,t.next=8,e.Login();case 8:e.loading=!1;case 9:case"end":return t.stop()}}),t)})))()}}};o("d6ea");Qe.render=Be,Qe.__scopeId="data-v-b77a4e62";var We=Qe,Ae={class:"userpage"},qe={class:"profile"},ze={style:{"text-align":"left"},class:"password_title"},Ke=Object(r["m"])("br",null,null,-1),Je={class:"info"},Ge={class:"infotext"},He=Object(r["m"])("i",{style:{"font-size":"50px"},class:"el-icon-paperclip"},null,-1),Xe=Object(r["m"])("h3",{style:{"margin-left":"10px","margin-top":"0px","font-size":"12px",color:"gray"}},"暱稱",-1),Ye={style:{"margin-left":"-20px","margin-top":"-5px","font-size":"20px"}},Ze=Object(r["m"])("br",null,null,-1),et=Object(r["m"])("i",{style:{"font-size":"50px"},class:"el-icon-message"},null,-1),tt=Object(r["m"])("h3",{style:{"margin-left":"10px","margin-top":"0px","font-size":"12px",color:"gray"}},"信箱",-1),ot={style:{"margin-left":"-20px","margin-top":"-5px","font-size":"20px"}},nt=Object(r["m"])("br",null,null,-1),rt=Object(r["m"])("i",{style:{"font-size":"50px"},class:"el-icon-user-solid"},null,-1),at=Object(r["m"])("h3",{style:{"margin-left":"10px","margin-top":"0px","font-size":"12px",color:"gray"}},"姓名",-1),it={style:{"margin-left":"-15px","margin-top":"-5px","font-size":"20px"}},ct=Object(r["m"])("br",null,null,-1),st=Object(r["l"])("編輯"),lt=Object(r["l"])("編輯"),ut=Object(r["l"])("儲存"),mt=Object(r["l"])("儲存"),dt=Object(r["m"])("i",{style:{"font-size":"50px"},class:"el-icon-postcard"},null,-1),bt=Object(r["m"])("h3",{style:{"margin-left":"10px","margin-top":"0px","font-size":"12px",color:"gray"}},"科系",-1),ft={style:{"margin-left":"-15px","margin-top":"-5px","font-size":"20px"}},pt=Object(r["m"])("br",null,null,-1),gt={class:"resetPWD"},ht=Object(r["m"])("h2",null,"變更密碼",-1),jt=Object(r["l"])("確認送出");function Ot(e,t,o,n,a,i){var c=Object(r["M"])("el-divider"),s=Object(r["M"])("el-row"),l=Object(r["M"])("el-button"),u=Object(r["M"])("el-alert"),m=Object(r["M"])("el-main"),d=Object(r["M"])("el-container"),b=Object(r["M"])("el-tab-pane"),f=Object(r["M"])("el-form-item"),p=Object(r["M"])("el-form"),g=Object(r["M"])("el-card"),h=Object(r["M"])("RoomList"),j=Object(r["M"])("el-tabs");return Object(r["D"])(),Object(r["i"])("div",Ae,[Object(r["m"])(j,{"tab-position":a.tabPosition},{default:Object(r["bb"])((function(){return[Object(r["m"])(b,{label:"     關於我        "},{default:Object(r["bb"])((function(){return[Object(r["m"])(d,null,{default:Object(r["bb"])((function(){return[Object(r["m"])(m,null,{default:Object(r["bb"])((function(){return[Object(r["m"])("div",qe,[Object(r["m"])("div",ze,[Object(r["m"])("h1",null,[Ke,Object(r["l"])("     "+Object(r["Q"])(a.user.nickname),1)])]),Object(r["m"])(c),Object(r["m"])("div",Je,[Object(r["m"])("div",Ge,[Object(r["m"])(s,null,{default:Object(r["bb"])((function(){return[He,Xe,Object(r["m"])("h2",Ye,[Ze,Object(r["l"])(Object(r["Q"])(a.user.nickname),1)])]})),_:1}),Object(r["m"])(s,null,{default:Object(r["bb"])((function(){return[et,tt,Object(r["m"])("h2",ot,[nt,Object(r["l"])(Object(r["Q"])(a.user.email),1)])]})),_:1}),Object(r["m"])(s,null,{default:Object(r["bb"])((function(){return[rt,at,Object(r["m"])("h2",it,[ct,Object(r["l"])(Object(r["Q"])(a.user.lastName)+",",1),Object(r["m"])(l,{class:"btn",onClick:i.clickLastName},{default:Object(r["bb"])((function(){return[st]})),_:1},8,["onClick"]),Object(r["l"])(" "+Object(r["Q"])(a.user.firstName),1),Object(r["m"])(l,{class:"btn",onClick:i.clickFirstName},{default:Object(r["bb"])((function(){return[lt]})),_:1},8,["onClick"])]),Object(r["cb"])(Object(r["m"])(u,{type:"info",onClose:i.cancelEditLastName},{default:Object(r["bb"])((function(){return[a.checkLastName?Object(r["cb"])((Object(r["D"])(),Object(r["i"])("input",{key:0,type:"text","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.lastName=t}),"prefix-icon":"fas fa-lock",onKeyup:t[2]||(t[2]=Object(r["db"])((function(){return i.saveLastName&&i.saveLastName.apply(i,arguments)}),["enter"])),ref:"newlastname"},null,544)),[[r["X"],e.lastName]]):Object(r["j"])("",!0),Object(r["cb"])(Object(r["m"])(l,{onClick:i.saveLastName},{default:Object(r["bb"])((function(){return[ut]})),_:1},8,["onClick"]),[[r["Y"],a.checkLastName]])]})),_:1},8,["onClose"]),[[r["Y"],a.checkLastName]]),Object(r["cb"])(Object(r["m"])(u,{type:"info",onClose:i.cancelEditFirstName},{default:Object(r["bb"])((function(){return[a.checkFirstName?Object(r["cb"])((Object(r["D"])(),Object(r["i"])("input",{key:0,type:"text","onUpdate:modelValue":t[3]||(t[3]=function(t){return e.firstName=t}),"prefix-icon":"fas fa-lock",onKeyup:t[4]||(t[4]=Object(r["db"])((function(){return i.saveFirstName&&i.saveFirstName.apply(i,arguments)}),["enter"])),ref:"newfirstname"},null,544)),[[r["X"],e.firstName]]):Object(r["j"])("",!0),Object(r["cb"])(Object(r["m"])(l,{onClick:i.saveFirstName},{default:Object(r["bb"])((function(){return[mt]})),_:1},8,["onClick"]),[[r["Y"],a.checkFirstName]])]})),_:1},8,["onClose"]),[[r["Y"],a.checkFirstName]])]})),_:1}),Object(r["m"])(s,null,{default:Object(r["bb"])((function(){return[dt,bt,Object(r["m"])("h2",ft,[pt,Object(r["l"])(Object(r["Q"])(a.user.department),1)])]})),_:1})])])])]})),_:1})]})),_:1})]})),_:1}),Object(r["m"])(b,{label:"     更改密碼     "},{default:Object(r["bb"])((function(){return[Object(r["m"])("div",gt,[Object(r["m"])(g,{class:"reset-card"},{default:Object(r["bb"])((function(){return[ht,Object(r["m"])(p,{class:"reset-form",model:a.passwordModel,rules:a.rules,ref:"form",onSubmit:Object(r["eb"])(e.submit,["prevent"])},{default:Object(r["bb"])((function(){return[Object(r["m"])(f,{prop:"oldPassword",label:"請輸入舊密碼"},{default:Object(r["bb"])((function(){return[Object(r["cb"])(Object(r["m"])("input",{center:"","onUpdate:modelValue":t[5]||(t[5]=function(e){return a.passwordModel.oldPassword=e}),placeholder:"請輸入舊密碼",type:"password","prefix-icon":"fas fa-lock",ref:"oldPassword",onKeyup:t[6]||(t[6]=Object(r["db"])((function(){return i.sumitChangePassword&&i.sumitChangePassword.apply(i,arguments)}),["enter"]))},null,544),[[r["X"],a.passwordModel.oldPassword]])]})),_:1}),Object(r["m"])(f,{prop:"newPassword1",label:"請輸入新密碼"},{default:Object(r["bb"])((function(){return[Object(r["cb"])(Object(r["m"])("input",{center:"","onUpdate:modelValue":t[7]||(t[7]=function(e){return a.passwordModel.newPassword1=e}),placeholder:"請輸入新密碼",type:"password","prefix-icon":"fas fa-lock",ref:"newPassword1",onKeyup:t[8]||(t[8]=Object(r["db"])((function(){return i.sumitChangePassword&&i.sumitChangePassword.apply(i,arguments)}),["enter"]))},null,544),[[r["X"],a.passwordModel.newPassword1]])]})),_:1}),Object(r["m"])(f,{prop:"newPassword2",label:"再輸入一次"},{default:Object(r["bb"])((function(){return[Object(r["cb"])(Object(r["m"])("input",{center:"","onUpdate:modelValue":t[9]||(t[9]=function(e){return a.passwordModel.newPassword2=e}),placeholder:"再輸入一次",type:"password","prefix-icon":"fas fa-lock",ref:"newPassword2",onKeyup:t[10]||(t[10]=Object(r["db"])((function(){return i.sumitChangePassword&&i.sumitChangePassword.apply(i,arguments)}),["enter"]))},null,544),[[r["X"],a.passwordModel.newPassword2]])]})),_:1}),Object(r["m"])(f,null,{default:Object(r["bb"])((function(){return[Object(r["m"])(l,{type:"info",round:"",onClick:i.sumitChangePassword},{default:Object(r["bb"])((function(){return[jt]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model","rules","onSubmit"])]})),_:1})])]})),_:1}),Object(r["m"])(b,{label:"     我的房間     "},{default:Object(r["bb"])((function(){return[Object(r["m"])(h)]})),_:1}),Object(r["m"])(b,{label:"     房主管理     "}),Object(r["m"])(b,{label:"     入房記錄     "})]})),_:1},8,["tab-position"])])}var vt=o("bc3a"),_t=o.n(vt),yt=o("4360"),kt=void 0;_t.a.defaults.xsrfCookieName="csrftoken",_t.a.defaults.xsrfHeaderName="X-CSRFToken";var wt=_t.a.create({baseURL:"http://localhost:8000",withCredentials:!1,headers:{Accept:"application/json","Content-Type":"application/json"}});wt.interceptors.request.use((function(e){var t=yt["a"].state.token;return t&&(e.headers.Authorization="Bearer "+t),e}),(function(e){return Promise.reject(e)})),wt.interceptors.response.use((function(e){return Promise.resolve(e)}),(function(e){if(e&&e.response)switch(e.response.status){case 401:console.log("登入無效"),yt["a"].dispatch("logout"),kt.$router.push("/");break;case 404:console.log("找不到該頁面");break;case 500:console.log("伺服器出錯");break;case 503:console.log("服務失效");break;default:console.log("連接錯誤".concat(e.response.status))}else console.log("連接到服務器失敗");return Promise.reject(e.response)}));var Rt={getUserId:function(){return wt.get("/api/user/get_id/")},getUser:function(e){return wt.get("/api/user/"+e+"/")},getUserRoom:function(){return wt.get("/user_room/")},putUserEdit:function(e,t,o){return wt.put("/api/user/"+e+"/",{last_name:t,first_name:o})},putChangePassword:function(e,t,o,n){return wt.put("/api/user/"+e+"/change_password/",{old_password:t,password:o,password2:n})}},xt=Object(r["fb"])("data-v-110218d8");Object(r["G"])("data-v-110218d8");var Mt={class:"userpage"},$t={"item-selector":".item","column-width":".item"};Object(r["E"])();var Ct=xt((function(e,t,o,n,a,i){var c=Object(r["M"])("router-view"),s=Object(r["M"])("RoomListCard"),l=Object(r["M"])("el-main"),u=Object(r["M"])("el-container"),m=Object(r["N"])("masonry-tile"),d=Object(r["N"])("masonry");return Object(r["D"])(),Object(r["i"])("div",Mt,[Object(r["m"])(u,null,{default:xt((function(){return[Object(r["m"])(c),a.rooms.length>0?(Object(r["D"])(),Object(r["i"])(l,{key:0,id:"roomCardContainer"},{default:xt((function(){return[Object(r["cb"])(Object(r["m"])("div",$t,[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(a.rooms,(function(e,t){return Object(r["cb"])((Object(r["D"])(),Object(r["i"])("div",{class:"item",key:t},[Object(r["m"])(s,{room:e},null,8,["room"])],512)),[[m]])})),128))],512),[[d,e.roomCardContainer]])]})),_:1})):Object(r["j"])("",!0)]})),_:1})])})),Vt=Object(r["fb"])("data-v-26877d1c");Object(r["G"])("data-v-26877d1c");var Lt={class:"image"},It={class:"info"},Dt={style:{"text-align":"left","margin-left":"40px"}},St=Object(r["l"])("introduction： "),Pt=Object(r["l"])("more");Object(r["E"])();var Tt=Vt((function(e,t,o,n,a,i){var c=Object(r["M"])("el-button"),s=Object(r["M"])("el-card");return Object(r["D"])(),Object(r["i"])(s,{"body-style":{padding:"0px"},class:"card"},{default:Vt((function(){return[Object(r["m"])("div",Lt,[Object(r["m"])("img",{src:a.images[o.room.id%4],width:"150"},null,8,["src"]),Object(r["m"])("h4",null,Object(r["Q"])(o.room.title),1)]),Object(r["m"])("div",It,[Object(r["m"])("div",Dt,[Object(r["m"])("p",null,"crate time："+Object(r["Q"])(o.room.create_time.slice(0,10))+" "+Object(r["Q"])(o.room.create_time.slice(11,19)),1),Object(r["m"])("p",null,"valid time："+Object(r["Q"])(o.room.valid_time),1),Object(r["m"])("p",null,"room type："+Object(r["Q"])(o.room.room_type),1),Object(r["m"])("p",null,"room category："+Object(r["Q"])(o.room.room_category),1),Object(r["m"])("p",null,"people limit:"+Object(r["Q"])(o.room.people_limit),1),Object(r["m"])("p",null,[St,Object(r["m"])(c,{type:"text",onClick:i.moreIntro},{default:Vt((function(){return[Pt]})),_:1},8,["onClick"])])])])]})),_:1})})),Nt={props:{room:Object},data:function(){return{images:["https://i.imgur.com/kN4J0UL.jpg","","https://i.imgur.com/17SSeJb.png","https://i.imgur.com/o2uS5WX.png","https://i.imgur.com/wc0HqRT.png","https://i.imgur.com/qdIZSWc.jpg","https://i.imgur.com/GOaM9dB.jpg","https://i.imgur.com/G65qPbl.jpg","https://i.imgur.com/WxiJ6K0.jpg"],host:""}},methods:{getMemberList:function(){return x["a"].getRoomMemberList(this.id)},moreIntro:function(){this.$alert(this.room.introduction,this.room.title,{confirmButtonText:"OK"})}}};o("ce2d");Nt.render=Tt,Nt.__scopeId="data-v-26877d1c";var Ut=Nt,Ft=o("3fd4"),Et={components:{RoomListCard:Ut},data:function(){return{rooms:[]}},created:function(){var e=this;this.$store.state.token?this.$store.dispatch("refreshToken",this.event).then((function(e){console.log(e),"status"in e&&console.log("[Home.vue.created.then] refreshToken then：\nstatus code: "+e.status+"\naccess token: "+JSON.stringify(e.data.access))})).then((function(){Rt.getUserRoom().then((function(t){e.rooms=t.data,console.log("aaaaaaaaa",t.data)})).catch((function(e){console.log("[Home.vue] error: created(), RoomService.getRooms():","\n理論上這邊不會再有錯誤了，注意一下\n",e.response)}))})).catch((function(t){console.log("[Home.vue.created.catch], token exist but:","\nstatus code: ",t.response.status,"\nerror message: ",JSON.stringify(t.response.data)),"code"in t.response.data&&"token_not_valid"==t.response.data["code"]&&(console.log("[Home.vue.created.catch] delete token"),e.$store.dispatch("resetToken")),e.$router.push({name:"login"})})):(console.log("plz login !"),Ft["a"].error("請登入 !"),this.$router.push({name:"login"}))}};o("b295");Et.render=Ct,Et.__scopeId="data-v-110218d8";var Bt=Et,Qt={props:["userToken","mailToken"],components:{RoomList:Bt},data:function(){var e=this,t=function(t,o,n){o!==e.passwordModel.newPassword1?n(new Error("兩次輸入密碼不一致 !")):n()};return{tabPosition:"left",checkLastName:!1,checkFirstName:!1,user:{id:0,nickname:"",email:"",department:"",lastName:"",firstName:""},passwordModel:{oldPassword:"",newPassword1:"",newPassword2:""},loading:!1,rules:{oldPassword:[{required:!0,message:"此為必填欄位",trigger:"blur"},{min:4,message:"密碼需至少4個字",trigger:"blur"}],newPassword1:[{required:!0,message:"此為必填欄位",trigger:"blur"},{min:4,message:"密碼需至少4個字",trigger:"blur"}],newPassword2:[{required:!0,message:"此為必填欄位",trigger:"blur"},{min:4,message:"密碼需至少4個字",trigger:"blur"},{validator:t,trigger:"blur"}]}}},created:function(){var e=this;return Object(ve["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.state.token?e.$store.dispatch("refreshToken").then((function(e){return console.log("f1",e),Rt.getUserId()})).then((function(t){return console.log("f2",t),e.user.id=t.data.id,console.log("f3",e.user.id),e.ser_fun()})).then((function(t){return console.log("4444",t),Rt.getUser(e.user.id)})).then((function(t){console.log("f4",t.data),e.user.email=t.data.email,e.user.nickname=t.data.email,e.user.department=t.data.department,e.user.lastName=t.data.last_name,e.user.firstName=t.data.first_name})).catch((function(t){"code"in t.response.data&&"token_not_valid"==t.response.data["code"]&&(e.$store.dispatch("resetToken"),e.$router.push({name:"login"}))})):(console.log("plz login !"),e.$router.push({name:"login"}));case 1:case"end":return t.stop()}}),t)})))()},methods:{clickLastName:function(){this.checkLastName=!0},cancelEditLastName:function(){this.checkLastName=!1},saveLastName:function(){this.checkLastName=!1,this.user.lastName=this.$refs.newlastname.value,console.log("666",this.$refs.newlastname.value),Rt.putUserEdit(this.user.id,this.$refs.newlastname.value,this.user.firstName)},clickFirstName:function(){this.checkFirstName=!0},cancelEditFirstName:function(){this.checkFirstName=!1},saveFirstName:function(){this.checkFirstName=!1,this.user.firstName=this.$refs.newfirstname.value,console.log("777",this.$refs.newfirstname.value),Rt.putUserEdit(this.user.id,this.user.lastName,this.$refs.newfirstname.value)},sumitChangePassword:function(){console.log("111"),""==this.$refs.oldPassword.value|""==this.$refs.newPassword1.value|""==this.$refs.newPassword2.value?(console.log("wrong1"),this.noInputPassword(),this.passwordModel.oldPassword="",this.passwordModel.newPassword1="",this.passwordModel.newPassword2=""):this.$refs.newPassword1.value!=this.$refs.newPassword2.value?(console.log("wrong2"),this.notEqualNewPassword(),this.passwordModel.oldPassword="",this.passwordModel.newPassword1="",this.passwordModel.newPassword2=""):(Rt.putChangePassword(this.user.id,this.$refs.oldPassword.value,this.$refs.newPassword1.value,this.$refs.newPassword2.value),console.log("222",this.user.id),console.log("333",this.$refs.oldPassword.value),console.log("444",this.$refs.newPassword1.value),console.log("555",this.$refs.newPassword2.value),this.finishChangePassword(),this.passwordModel.oldPassword="",this.passwordModel.newPassword1="",this.passwordModel.newPassword2="")},notEqualNewPassword:function(){this.$message({message:"兩次密碼不一致",center:!0,type:"warning"})},noInputPassword:function(){this.$message({message:"輸入不能為空白",center:!0,type:"warning"})},finishChangePassword:function(){this.$message({message:"修改成功",center:!0,type:"success"})},ser_fun:function(){}}};o("7e35");Qt.render=Ot;var Wt=Qt,At=Object(r["fb"])("data-v-51d37446");Object(r["G"])("data-v-51d37446");var qt={class:"resetPWD"},zt=Object(r["m"])("h2",null,"重設密碼",-1),Kt=Object(r["l"])("提交");Object(r["E"])();var Jt=At((function(e,t,o,n,a,i){var c=Object(r["M"])("el-input"),s=Object(r["M"])("el-form-item"),l=Object(r["M"])("el-button"),u=Object(r["M"])("el-form"),m=Object(r["M"])("el-card");return Object(r["D"])(),Object(r["i"])("div",qt,[Object(r["m"])(m,{class:"reset-card"},{default:At((function(){return[zt,Object(r["m"])(u,{class:"reset-form",model:a.model,rules:a.rules,ref:"form",onSubmit:Object(r["eb"])(i.submit,["prevent"])},{default:At((function(){return[Object(r["m"])(s,{prop:"password",label:"新密碼"},{default:At((function(){return[Object(r["m"])(c,{modelValue:a.model.password,"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.model.password=e}),placeholder:"Input password",type:"password","prefix-icon":"fas fa-lock"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(s,{prop:"repeatPassword",label:"再輸入一次"},{default:At((function(){return[Object(r["m"])(c,{modelValue:a.model.repeatPassword,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.model.repeatPassword=e}),placeholder:"Input password again",type:"password","prefix-icon":"fas fa-repeat"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(s,null,{default:At((function(){return[Object(r["m"])(l,{loading:a.loading,class:"login-button",type:"primary","native-type":"submit",block:""},{default:At((function(){return[Kt]})),_:1},8,["loading"])]})),_:1})]})),_:1},8,["model","rules","onSubmit"])]})),_:1})])})),Gt={props:["userToken","mailToken"],data:function(){var e=this,t=function(t,o,n){o!==e.model.password?n(new Error("兩次輸入密碼不一致 !")):n()};return{loading:!1,model:{password:"",repeatPassword:""},rules:{password:[{required:!0,message:"Password is required",trigger:"blur"},{min:4,message:"Password length should be at least 4 characters",trigger:"blur"}],repeatPassword:[{required:!0,message:"Password is required",trigger:"blur"},{min:4,message:"Password length should be at least 4 characters",trigger:"blur"},{validator:t,trigger:"blur"}]}}},created:function(){this.forDev()},methods:{forDev:function(){this.model.password="test",this.model.repeatPassword="test"},submitReset:function(){return console.log("submitReset"),x["a"].postResetPassword(this.userToken,this.mailToken,this.model.password)},simulateLogin:function(){return new Promise((function(e){setTimeout(e,800)}))},submit:function(){var e=this;return Object(ve["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.form.validate();case 2:if(o=t.sent,o){t.next=5;break}return t.abrupt("return");case 5:return e.loading=!0,t.next=8,e.submitReset().then((function(t){e.$message.success("修改成功 !"),console.log(t),e.$router.push({name:"login"})})).catch((function(t){e.$message.error("有些問題發生了 ! 請聯繫管理員 QQ"),console.log(t)}));case 8:e.loading=!1;case 9:case"end":return t.stop()}}),t)})))()}}};o("73eb");Gt.render=Jt,Gt.__scopeId="data-v-51d37446";var Ht=Gt,Xt=Object(r["fb"])("data-v-2a49a6ef");Object(r["G"])("data-v-2a49a6ef");var Yt={class:"cr-container"},Zt=Object(r["m"])("div",{class:"mars"},null,-1),eo={key:0,src:"https://assets.codepen.io/1538474/404.svg",class:"logo-404"},to=Object(r["m"])("img",{src:"https://assets.codepen.io/1538474/meteor.svg",class:"meteor"},null,-1),oo={class:"title"},no={class:"subtitle"},ro=Object(r["m"])("div",{align:"center"},[Object(r["m"])("a",{class:"btn-back",href:"/"},"Back to home page")],-1),ao=Object(r["m"])("img",{src:"https://assets.codepen.io/1538474/astronaut.svg",class:"astronaut"},null,-1),io=Object(r["m"])("img",{src:"https://assets.codepen.io/1538474/spaceship.svg",class:"spaceship"},null,-1);Object(r["E"])();var co=Xt((function(e,t,o,n,a,i){return Object(r["D"])(),Object(r["i"])("div",Yt,[Zt,"404"==o.type?(Object(r["D"])(),Object(r["i"])("img",eo)):Object(r["j"])("",!0),to,Object(r["m"])("p",oo,Object(r["Q"])(a.title),1),Object(r["m"])("p",no,Object(r["Q"])(a.description),1),ro,ao,io])})),so={props:["type","token","userToken"],data:function(){return{title:"Oh no!!",description:"You’re either misspelling the URL \n or requesting a page that's no longer here."}},created:function(){this.init()},methods:{init:function(){var e=this;"verify-mail"==this.type?(this.title="Mail Verification",x["a"].getMailVerify(this.userToken,this.token).then((function(t){"success"==t.data?e.description="Verify Successful !":console.log(t.data)})).catch((function(t){e.description=t.data}))):"permission-deny"==this.type&&(this.title="Permission Deny",this.description="可能是因為您不是該房間成員、或是已被封鎖 \n 故無法進入該房間 !")}}};o("8bd8");so.render=co,so.__scopeId="data-v-2a49a6ef";var lo=so,uo=Object(r["fb"])("data-v-9ec4355a");Object(r["G"])("data-v-9ec4355a");var mo={class:"register"},bo=Object(r["m"])("h2",null,"註冊",-1),fo=Object(r["m"])("span",null,"@ntu.edu.tw",-1),po=Object(r["l"])("提交");Object(r["E"])();var go=uo((function(e,t,o,n,a,i){var c=Object(r["M"])("el-input"),s=Object(r["M"])("el-col"),l=Object(r["M"])("el-form-item"),u=Object(r["M"])("el-button"),m=Object(r["M"])("el-form"),d=Object(r["M"])("el-card");return Object(r["D"])(),Object(r["i"])("div",mo,[Object(r["m"])(d,{class:"register-card"},{default:uo((function(){return[bo,Object(r["m"])(m,{class:"register-form",model:a.model,rules:a.rules,ref:"form",onSubmit:Object(r["eb"])(i.register,["prevent"])},{default:uo((function(){return[Object(r["m"])(l,{label:"E-mail (* 僅可用 ntu.edu.tw 註冊，填學號)",prop:"email"},{default:uo((function(){return[Object(r["m"])(s,{span:12},{default:uo((function(){return[Object(r["m"])(c,{modelValue:a.model.email,"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.model.email=e}),placeholder:"Email","prefix-icon":"el-icon-user"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(s,{span:7},{default:uo((function(){return[fo]})),_:1})]})),_:1}),Object(r["m"])(l,{label:"密碼",prop:"password"},{default:uo((function(){return[Object(r["m"])(c,{modelValue:a.model.password,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.model.password=e}),placeholder:"請輸入密碼",type:"password","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(l,{label:"請再輸入一次密碼",prop:"password2"},{default:uo((function(){return[Object(r["m"])(c,{modelValue:a.model.password2,"onUpdate:modelValue":t[3]||(t[3]=function(e){return a.model.password2=e}),placeholder:"再輸入一次密碼",type:"password","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(l,{label:"姓名",required:""},{default:uo((function(){return[Object(r["m"])(s,{span:8},{default:uo((function(){return[Object(r["m"])(l,{prop:"last_name"},{default:uo((function(){return[Object(r["m"])(c,{"prefix-icon":"el-icon-user",modelValue:a.model.last_name,"onUpdate:modelValue":t[4]||(t[4]=function(e){return a.model.last_name=e}),placeholder:"姓"},null,8,["modelValue"])]})),_:1})]})),_:1}),Object(r["m"])(s,{span:8},{default:uo((function(){return[Object(r["m"])(l,{prop:"first_name"},{default:uo((function(){return[Object(r["m"])(c,{modelValue:a.model.first_name,"onUpdate:modelValue":t[5]||(t[5]=function(e){return a.model.first_name=e}),placeholder:"名"},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),Object(r["m"])(l,{label:"系籍",prop:"department",required:""},{default:uo((function(){return[Object(r["m"])(c,{modelValue:a.model.department,"onUpdate:modelValue":t[6]||(t[6]=function(e){return a.model.department=e}),placeholder:"系籍","prefix-icon":"el-icon-folder"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(l,{label:"暱稱",prop:"nickname",required:""},{default:uo((function(){return[Object(r["m"])(c,{modelValue:a.model.nickname,"onUpdate:modelValue":t[7]||(t[7]=function(e){return a.model.nickname=e}),placeholder:"Nickname","prefix-icon":"el-icon-chat-round"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(l,null,{default:uo((function(){return[Object(r["m"])(u,{loading:a.loading,class:"register-button",type:"primary","native-type":"submit",block:""},{default:uo((function(){return[po]})),_:1},8,["loading"])]})),_:1})]})),_:1},8,["model","rules","onSubmit"])]})),_:1})])})),ho={data:function(){var e=this,t=function(t,o,n){o!==e.model.password?n(new Error("兩次輸入密碼不一致 !")):n()};return{model:{email:"",password:"",password2:"",last_name:"",first_name:"",department:"",nickname:""},loading:!1,rules:{email:[{required:!0,message:"必須填寫(寫學號就好)",trigger:"blur"},{min:4,message:"Email length should be at least 4 characters",trigger:"blur"}],password:[{required:!0,message:"必須填寫",trigger:"blur"},{min:4,message:"請設定至少四個字以上",trigger:"blur"}],password2:[{required:!0,message:"必須填寫",trigger:"blur"},{min:4,message:"請設定至少四個字以上",trigger:"blur"},{validator:t,trigger:"blur"}],last_name:[{required:!0,message:"姓 必須填寫",trigger:"blur"}],first_name:[{required:!0,message:"名 必須填寫",trigger:"blur"}],department:[{required:!0,message:"系籍必須填寫",trigger:"blur"}],nickname:[{required:!0,message:"暱稱必須填寫",trigger:"blur"}]}}},created:function(){this.forDev()},methods:{forDev:function(){this.model.email="r09921119",this.model.password="test",this.model.password2="test",this.model.last_name="許",this.model.first_name="凱荃",this.model.department="電機系",this.model.nickname="MeteorV"},submitRegister:function(){console.log("submitRegister");var e=Object.assign({},this.model);return e.email=e.email+"@ntu.edu.tw",x["a"].postRegister(e)},simulateLogin:function(){return new Promise((function(e){setTimeout(e,800)}))},register:function(){var e=this;return Object(ve["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.form.validate();case 2:if(o=t.sent,o){t.next=5;break}return t.abrupt("return");case 5:return e.loading=!0,t.next=8,e.submitRegister().then((function(t){e.$message.success("註冊成功 ! 記得去信箱收信 !"),console.log(t),e.$router.push({name:"login"})})).catch((function(t){for(var o=0,n=Object.entries(t.data);o<n.length;o++){var r=Object(U["a"])(n[o],2),a=r[0],i=r[1];e.$message.error(a+": "+i[0]),console.log(a+": "+i[0])}}));case 8:e.loading=!1;case 9:case"end":return t.stop()}}),t)})))()}}};o("77b6");ho.render=go,ho.__scopeId="data-v-9ec4355a";var jo=ho,Oo=[{path:"/",name:"home",component:C},{path:"/room/create",name:"room-create",component:E},{path:"/room/:id",name:"room-show",component:Pe,props:!0},{path:"/about",name:"about",component:function(){return o.e("about").then(o.bind(null,"f820"))}},{path:"/login",name:"login",component:We},{path:"/register",name:"register",component:jo},{path:"/forgetpwd/:userToken/:mailToken",name:"mail-verify",component:Ht,props:!0},{path:"/profile",name:"profile",component:Wt},{path:"/:type",name:"unknow-redirect",component:lo,props:!0},{path:"/:type/:userToken/:token",name:"verify-mail",component:lo,props:!0}],vo=Object(n["a"])({history:Object(n["b"])("/"),routes:Oo});t["a"]=vo},a234:function(e,t,o){},acb1:function(e,t,o){"use strict";o("f2f6")},b295:function(e,t,o){"use strict";o("f6d7")},b740:function(e,t,o){"use strict";o("a234")},c1be:function(e,t,o){"use strict";o("3808")},c5b9:function(e,t,o){},cbd3:function(e,t,o){},ce2d:function(e,t,o){"use strict";o("3cfb")},cf76:function(e,t,o){"use strict";o("e5df")},d6ea:function(e,t,o){"use strict";o("27e4")},e5df:function(e,t,o){},ef13:function(e,t){function o(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id="ef13"},f2f6:function(e,t,o){},f4d2:function(e,t,o){"use strict";o("cbd3")},f6d7:function(e,t,o){},fdac:function(e,t,o){}});
//# sourceMappingURL=app.1ed447bd.js.map